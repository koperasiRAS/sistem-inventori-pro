<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Inventori Aset RAS</title>
    <!-- Netlify Identity Widget -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <!-- PWA Manifest -->
    <link rel="manifest" href="/site.webmanifest">

    <!-- Theme Color -->
    <meta name="theme-color" content="#4f46e5">

    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="/assets/icon-192x192.png">

    <!-- Viewport untuk PWA -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- Netlify Redirect Script -->
    <script>
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on("init", user => {
                if (!user) {
                    window.netlifyIdentity.on("login", () => {
                        document.location.href = "/admin/";
                    });
                }
            });
        }
        
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registered:', registration);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
    </script>

    <!-- Cache Control -->
    <meta http-equiv="Cache-Control" content="public, max-age=3600">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out;
        }
        
        /* Loading */
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4f46e5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Toast */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        /* Table Scroll */
        .table-container {
            overflow-x: auto;
            max-width: 100%;
        }
        
        /* Barcode Preview */
        .barcode-preview {
            font-family: 'Libre Barcode 128', monospace;
            font-size: 32px;
        }
        
        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }
        
        /* Navigation Buttons */
        .nav-btn {
            transition: all 0.2s ease;
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Pagination */
        .pagination-btn {
            transition: all 0.2s ease;
        }
        
        .pagination-btn:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .pagination-btn.active {
            background-color: #4f46e5;
            color: white;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Barcode+128&display=swap" rel="stylesheet">
</head>
<body>
    <div id="root"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;
        
        // ==================== STORAGE UTILITIES ====================
        const storage = {
            get: (key) => {
                try {
                    const value = localStorage.getItem(key);
                    return value ? JSON.parse(value) : null;
                } catch (error) {
                    console.error('Storage error:', error);
                    return null;
                }
            },
            
            set: (key, value) => {
                try {
                    localStorage.setItem(key, JSON.stringify(value));
                    return true;
                } catch (error) {
                    console.error('Storage error:', error);
                    return false;
                }
            },
            
            remove: (key) => {
                try {
                    localStorage.removeItem(key);
                    return true;
                } catch (error) {
                    console.error('Storage error:', error);
                    return false;
                }
            },
            
            clear: () => {
                try {
                    localStorage.clear();
                    return true;
                } catch (error) {
                    console.error('Storage error:', error);
                    return false;
                }
            }
        };

        // ==================== ICON COMPONENTS ====================
        const Icon = {
            Dashboard: () => <span>üìä</span>,
            Inventory: () => <span>üì¶</span>,
            History: () => <span>üìú</span>,
            Report: () => <span>üìà</span>,
            Settings: () => <span>‚öôÔ∏è</span>,
            Users: () => <span>üë•</span>,
            Supplier: () => <span>üè¢</span>,
            Purchase: () => <span>üõí</span>,
            Stocktake: () => <span>üìã</span>,
            Barcode: () => <span>üì∑</span>,
            Location: () => <span>üìç</span>,
            Add: () => <span>‚ûï</span>,
            Edit: () => <span>‚úèÔ∏è</span>,
            Delete: () => <span>üóëÔ∏è</span>,
            Search: () => <span>üîç</span>,
            Download: () => <span>üì•</span>,
            Upload: () => <span>üì§</span>,
            Print: () => <span>üñ®Ô∏è</span>,
            User: () => <span>üë§</span>,
            Logout: () => <span>üö™</span>,
            Check: () => <span>‚úÖ</span>,
            Alert: () => <span>‚ö†Ô∏è</span>,
            Chart: () => <span>üìä</span>,
            Filter: () => <span>üîß</span>,
            Backup: () => <span>üíæ</span>,
            Restore: () => <span>üîÑ</span>,
            Calendar: () => <span>üìÖ</span>,
            Clock: () => <span>‚è∞</span>,
            Dollar: () => <span>üí∞</span>,
            Package: () => <span>üì¶</span>,
            Truck: () => <span>üöö</span>,
            Warehouse: () => <span>üè≠</span>,
            Home: () => <span>üè†</span>,
            Next: () => <span>‚Üí</span>,
            Prev: () => <span>‚Üê</span>,
            FirstPage: () => <span>‚èÆÔ∏è</span>,
            LastPage: () => <span>‚è≠Ô∏è</span>
        };

        // ==================== TOAST COMPONENT ====================
        const Toast = ({ message, type, onClose }) => {
            useEffect(() => {
                const timer = setTimeout(onClose, 3000);
                return () => clearTimeout(timer);
            }, [onClose]);

            const bgColor = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                warning: 'bg-yellow-500',
                info: 'bg-blue-500'
            }[type];

            return (
                <div className={`${bgColor} text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-2 mb-2 animate-fadeIn`}>
                    <span>{message}</span>
                    <button onClick={onClose} className="ml-auto opacity-80 hover:opacity-100">‚úï</button>
                </div>
            );
        };

        // ==================== LOADING COMPONENT ====================
        const LoadingScreen = () => (
            <div className="fixed inset-0 bg-white flex items-center justify-center z-50">
                <div className="text-center">
                    <div className="loading-spinner mb-4"></div>
                    <p className="text-gray-600">Memuat sistem inventori...</p>
                </div>
            </div>
        );

        // ==================== PAGINATION COMPONENT ====================
        const Pagination = ({ 
            currentPage, 
            totalItems, 
            itemsPerPage, 
            onPageChange,
            onItemsPerPageChange 
        }) => {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            
            // Generate page numbers to show
            const getPageNumbers = () => {
                const pageNumbers = [];
                const maxPagesToShow = 5;
                
                if (totalPages <= maxPagesToShow) {
                    // Show all pages
                    for (let i = 1; i <= totalPages; i++) {
                        pageNumbers.push(i);
                    }
                } else {
                    // Show limited pages with ellipsis
                    if (currentPage <= 3) {
                        // Near the beginning
                        for (let i = 1; i <= 4; i++) {
                            pageNumbers.push(i);
                        }
                        pageNumbers.push('...');
                        pageNumbers.push(totalPages);
                    } else if (currentPage >= totalPages - 2) {
                        // Near the end
                        pageNumbers.push(1);
                        pageNumbers.push('...');
                        for (let i = totalPages - 3; i <= totalPages; i++) {
                            pageNumbers.push(i);
                        }
                    } else {
                        // In the middle
                        pageNumbers.push(1);
                        pageNumbers.push('...');
                        for (let i = currentPage - 1; i <= currentPage + 1; i++) {
                            pageNumbers.push(i);
                        }
                        pageNumbers.push('...');
                        pageNumbers.push(totalPages);
                    }
                }
                
                return pageNumbers;
            };

            if (totalItems === 0) return null;

            const pageNumbers = getPageNumbers();
            const startItem = (currentPage - 1) * itemsPerPage + 1;
            const endItem = Math.min(currentPage * itemsPerPage, totalItems);

            return (
                <div className="flex flex-col sm:flex-row items-center justify-between gap-4 mt-6 p-4 bg-white rounded-lg border">
                    {/* Items per page selector */}
                    <div className="flex items-center gap-2">
                        <span className="text-sm text-gray-600">Items per page:</span>
                        <select
                            value={itemsPerPage}
                            onChange={(e) => onItemsPerPageChange(parseInt(e.target.value))}
                            className="px-2 py-1 border border-gray-300 rounded text-sm"
                        >
                            <option value="5">5</option>
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                    </div>
                    
                    {/* Page info */}
                    <div className="text-sm text-gray-600">
                        Menampilkan <span className="font-semibold">{startItem}-{endItem}</span> dari <span className="font-semibold">{totalItems}</span> item
                    </div>
                    
                    {/* Pagination controls */}
                    <div className="flex items-center gap-1">
                        {/* First Page */}
                        <button
                            onClick={() => onPageChange(1)}
                            disabled={currentPage === 1}
                            className="px-3 py-1 rounded pagination-btn disabled:opacity-50 disabled:cursor-not-allowed"
                            title="Halaman Pertama"
                        >
                            <Icon.FirstPage />
                        </button>
                        
                        {/* Previous Page */}
                        <button
                            onClick={() => onPageChange(currentPage - 1)}
                            disabled={currentPage === 1}
                            className="px-3 py-1 rounded pagination-btn disabled:opacity-50 disabled:cursor-not-allowed"
                            title="Halaman Sebelumnya"
                        >
                            <Icon.Prev />
                        </button>
                        
                        {/* Page Numbers */}
                        {pageNumbers.map((pageNum, index) => (
                            pageNum === '...' ? (
                                <span key={`ellipsis-${index}`} className="px-2">...</span>
                            ) : (
                                <button
                                    key={pageNum}
                                    onClick={() => onPageChange(pageNum)}
                                    className={`w-8 h-8 flex items-center justify-center rounded pagination-btn ${
                                        currentPage === pageNum 
                                        ? 'bg-blue-600 text-white' 
                                        : 'hover:bg-gray-100'
                                    }`}
                                >
                                    {pageNum}
                                </button>
                            )
                        ))}
                        
                        {/* Next Page */}
                        <button
                            onClick={() => onPageChange(currentPage + 1)}
                            disabled={currentPage === totalPages}
                            className="px-3 py-1 rounded pagination-btn disabled:opacity-50 disabled:cursor-not-allowed"
                            title="Halaman Selanjutnya"
                        >
                            <Icon.Next />
                        </button>
                        
                        {/* Last Page */}
                        <button
                            onClick={() => onPageChange(totalPages)}
                            disabled={currentPage === totalPages}
                            className="px-3 py-1 rounded pagination-btn disabled:opacity-50 disabled:cursor-not-allowed"
                            title="Halaman Terakhir"
                        >
                            <Icon.LastPage />
                        </button>
                    </div>
                </div>
            );
        };

        // ==================== LOGIN COMPONENT ====================
        const LoginPage = ({ onLogin }) => {
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');
            const [loading, setLoading] = useState(false);

            const handleSubmit = (e) => {
                e.preventDefault();
                setLoading(true);

                setTimeout(() => {
                    const users = {
                        'admin': { 
                            password: 'admin123', 
                            role: 'admin',
                            permissions: ['read', 'write', 'delete', 'stocktake']
                        },
                        'owner': { 
                            password: 'owner123', 
                            role: 'owner',
                            permissions: ['read', 'write', 'delete', 'stocktake', 'manage_users', 'manage_suppliers', 'backup_restore']
                        },
                        'staff': { 
                            password: 'staff123', 
                            role: 'staff',
                            permissions: ['read']
                        }
                    };

                    if (users[username] && users[username].password === password) {
                        onLogin({ 
                            username, 
                            role: users[username].role,
                            permissions: users[username].permissions
                        });
                    } else {
                        alert('‚ùå Username atau password salah!');
                        setLoading(false);
                    }
                }, 500);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
                    <div className="w-full max-w-md">
                        <div className="bg-white rounded-2xl shadow-xl p-8">
                            <div className="text-center mb-8">
                                <div className="w-20 h-20 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                                    <span className="text-3xl font-bold text-white">RAS</span>
                                </div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Sistem Inventori Aset RAS</h1>
                                <p className="text-gray-600">Manajemen Inventori Aset Lengkap</p>
                            </div>

                            <form onSubmit={handleSubmit} className="space-y-6">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Username
                                    </label>
                                    <input
                                        type="text"
                                        value={username}
                                        onChange={(e) => setUsername(e.target.value)}
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        placeholder="Masukkan username"
                                        required
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Password
                                    </label>
                                    <input
                                        type="password"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                        required
                                    />
                                </div>

                                <button
                                    type="submit"
                                    disabled={loading}
                                    className="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-3 rounded-lg font-semibold hover:opacity-90 transition disabled:opacity-50"
                                >
                                    {loading ? 'Memproses...' : 'Masuk ke Sistem'}
                                </button>

                                <div className="text-center text-sm text-gray-500 pt-4 border-t">
                                    <p className="mb-2">Default credentials:</p>
                                    <div className="space-y-1 text-xs">
                                        <p>Admin: <code className="bg-gray-100 px-2 py-1 rounded">admin / admin123</code></p>
                                        <p>Owner: <code className="bg-gray-100 px-2 py-1 rounded">owner / owner123</code></p>
                                        <p>Staff: <code className="bg-gray-100 px-2 py-1 rounded">staff / staff123</code></p>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            );
        };

        // ==================== BARCODE GENERATOR ====================
        const BarcodeGenerator = ({ code, showText = true }) => {
            if (!code) return null;
            
            return (
                <div className="flex flex-col items-center">
                    <div className="barcode-preview text-center p-4 bg-white border rounded-lg">
                        {code}
                    </div>
                    {showText && (
                        <div className="mt-2 text-sm text-gray-600 font-mono">{code}</div>
                    )}
                </div>
            );
        };

        // ==================== MAIN APP COMPONENT ====================
        const App = () => {
            // ==================== STATE MANAGEMENT ====================
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);
            const [toasts, setToasts] = useState([]);
            const [activeTab, setActiveTab] = useState('dashboard');
            
            // Data states
            const [items, setItems] = useState([]);
            const [history, setHistory] = useState([]);
            const [suppliers, setSuppliers] = useState([]);
            const [purchaseOrders, setPurchaseOrders] = useState([]);
            const [stocktakes, setStocktakes] = useState([]);
            const [users, setUsers] = useState([]);
            const [locations, setLocations] = useState([]);
            
            // Pagination states
            const [currentPage, setCurrentPage] = useState(1);
            const [itemsPerPage, setItemsPerPage] = useState(10);
            
            // Form states
            const [showItemForm, setShowItemForm] = useState(false);
            const [showSupplierForm, setShowSupplierForm] = useState(false);
            const [showPOForm, setShowPOForm] = useState(false);
            const [showStocktakeForm, setShowStocktakeForm] = useState(false);
            const [showUserForm, setShowUserForm] = useState(false);
            const [showLocationForm, setShowLocationForm] = useState(false);
            
            // Filter states
            const [searchTerm, setSearchTerm] = useState('');
            const [filters, setFilters] = useState({
                kategori: '',
                lokasi: '',
                supplier: '',
                status: ''
            });
            
            // Form data
            const [formData, setFormData] = useState({
                // Item form
                id: null,
                kode: '',
                nama: '',
                kategori: '',
                lokasi: '',
                jumlah: '',
                satuan: '',
                harga: '',
                stokMinimal: '',
                supplierId: '',
                barcode: '',
                
                // Supplier form
                supplierName: '',
                supplierContact: '',
                supplierAddress: '',
                supplierPhone: '',
                supplierEmail: '',
                
                // Purchase Order form
                poNumber: '',
                poSupplierId: '',
                poItems: [],
                poDate: '',
                poStatus: 'pending',
                
                // Stocktake form
                stDate: '',
                stItems: [],
                stNotes: '',
                
                // User form
                userUsername: '',
                userPassword: '',
                userRole: 'staff',
                userPermissions: [],
                
                // Location form
                locationName: '',
                locationCode: '',
                locationCapacity: '',
                locationType: 'kantor'
            });

            // ==================== CONSTANTS ====================
            const categories = [
                'Elektronik', 'Makanan & Minuman', 'Alat Tulis Kantor', 'Pakaian',
                'Bahan Bangunan', 'Obat-obatan', 'Perabotan', 'Kendaraan', 'Lainnya'
            ];
            
            const units = ['Pcs', 'Box', 'Kg', 'Liter', 'Lusin', 'Pack', 'Roll', 'Set', 'Unit', 'Meter'];
            
            const locationTypes = ['Kantor', 'Gudang', 'Rak', 'Lemari', 'Freezer', 'Showroom', 'Lainnya'];
            
            const userRoles = [
                { value: 'staff', label: 'Staff' },
                { value: 'admin', label: 'Admin' },
                { value: 'owner', label: 'Owner' }
            ];
            
            const permissionsList = [
                { id: 'read', label: 'Lihat Data' },
                { id: 'write', label: 'Tambah/Edit Data' },
                { id: 'delete', label: 'Hapus Data' },
                { id: 'stocktake', label: 'Stock Opname' },
                { id: 'manage_suppliers', label: 'Kelola Supplier' },
                { id: 'manage_users', label: 'Kelola User' },
                { id: 'backup_restore', label: 'Backup/Restore' }
            ];
            
            const poStatuses = [
                { value: 'pending', label: 'Menunggu', color: 'yellow' },
                { value: 'ordered', label: 'Dipesan', color: 'blue' },
                { value: 'received', label: 'Diterima', color: 'green' },
                { value: 'cancelled', label: 'Dibatalkan', color: 'red' }
            ];

            // Navigation tabs (expanded)
            const tabs = [
                { id: 'dashboard', label: 'Dashboard', icon: Icon.Dashboard, requiredPermission: 'read' },
                { id: 'inventory', label: 'Inventori', icon: Icon.Inventory, requiredPermission: 'read' },
                { id: 'suppliers', label: 'Supplier', icon: Icon.Supplier, requiredPermission: 'manage_suppliers' },
                { id: 'purchase', label: 'Purchase Order', icon: Icon.Purchase, requiredPermission: 'write' },
                { id: 'stocktake', label: 'Stock Opname', icon: Icon.Stocktake, requiredPermission: 'stocktake' },
                { id: 'barcode', label: 'Barcode', icon: Icon.Barcode, requiredPermission: 'read' },
                { id: 'locations', label: 'Lokasi', icon: Icon.Location, requiredPermission: 'write' },
                { id: 'users', label: 'Users', icon: Icon.Users, requiredPermission: 'manage_users' },
                { id: 'history', label: 'Riwayat', icon: Icon.History, requiredPermission: 'read' },
                { id: 'report', label: 'Laporan', icon: Icon.Report, requiredPermission: 'read' },
                { id: 'settings', label: 'Pengaturan', icon: Icon.Settings, requiredPermission: 'read' }
            ];

            // ==================== PAGINATION FUNCTIONS ====================
            const handlePageChange = (pageNumber) => {
                setCurrentPage(pageNumber);
                // Scroll to top of table
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            const handleItemsPerPageChange = (newItemsPerPage) => {
                setItemsPerPage(newItemsPerPage);
                setCurrentPage(1); // Reset to first page when changing items per page
            };

            // ==================== NAVIGATION FUNCTIONS ====================
            const getCurrentTabIndex = () => {
                const availableTabs = getAvailableTabs();
                return availableTabs.findIndex(tab => tab.id === activeTab);
            };

            const getAvailableTabs = () => {
                return tabs.filter(tab => 
                    checkPermission(tab.requiredPermission) || user?.role === 'owner'
                );
            };

            const navigateTo = (direction) => {
                const availableTabs = getAvailableTabs();
                const currentIndex = availableTabs.findIndex(tab => tab.id === activeTab);
                
                if (direction === 'next') {
                    if (currentIndex < availableTabs.length - 1) {
                        setActiveTab(availableTabs[currentIndex + 1].id);
                    }
                } else if (direction === 'prev') {
                    if (currentIndex > 0) {
                        setActiveTab(availableTabs[currentIndex - 1].id);
                    }
                } else if (direction === 'home') {
                    setActiveTab('dashboard');
                }
            };

            // Navigation Button Component
            const NavigationButtons = () => {
                const availableTabs = getAvailableTabs();
                const currentIndex = availableTabs.findIndex(tab => tab.id === activeTab);
                
                return (
                    <div className="flex items-center gap-2 mt-4 mb-2">
                        <button
                            onClick={() => navigateTo('home')}
                            className="flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 nav-btn"
                            title="Home (Dashboard)"
                        >
                            <Icon.Home />
                            <span className="hidden sm:inline">Home</span>
                        </button>
                        
                        <div className="flex-1"></div>
                        
                        <button
                            onClick={() => navigateTo('prev')}
                            disabled={currentIndex <= 0}
                            className={`flex items-center gap-2 px-3 py-2 ${currentIndex > 0 ? 'bg-gray-200 hover:bg-gray-300' : 'bg-gray-100'} rounded-lg nav-btn`}
                            title="Sebelumnya"
                        >
                            <Icon.Prev />
                            <span className="hidden sm:inline">Sebelumnya</span>
                        </button>
                        
                        <button
                            onClick={() => navigateTo('next')}
                            disabled={currentIndex >= availableTabs.length - 1}
                            className={`flex items-center gap-2 px-3 py-2 ${currentIndex < availableTabs.length - 1 ? 'bg-gray-200 hover:bg-gray-300' : 'bg-gray-100'} rounded-lg nav-btn`}
                            title="Selanjutnya"
                        >
                            <span className="hidden sm:inline">Selanjutnya</span>
                            <Icon.Next />
                        </button>
                    </div>
                );
            };

            // ==================== INITIALIZATION ====================
            useEffect(() => {
                initializeApp();
            }, []);

            useEffect(() => {
                // Reset to page 1 when search or filters change
                setCurrentPage(1);
            }, [searchTerm, filters]);

            const initializeApp = () => {
                try {
                    // Load all data from localStorage
                    const savedUser = storage.get('inventory_user');
                    if (savedUser) {
                        setUser(savedUser);
                    }

                    // Load all data with fallback to empty arrays
                    setItems(storage.get('inventory_items') || []);
                    setHistory(storage.get('inventory_history') || []);
                    setSuppliers(storage.get('inventory_suppliers') || []);
                    setPurchaseOrders(storage.get('inventory_purchase_orders') || []);
                    setStocktakes(storage.get('inventory_stocktakes') || []);
                    setUsers(storage.get('inventory_users') || []);
                    
                    // Initialize locations with Kantor 1, Kantor 2, etc.
                    const defaultLocations = [
                        { id: 1, name: 'Kantor 1', code: 'KTR-01', capacity: 500, type: 'kantor', currentItems: 0 },
                        { id: 2, name: 'Kantor 2', code: 'KTR-02', capacity: 300, type: 'kantor', currentItems: 0 },
                        { id: 3, name: 'Kantor Pusat', code: 'KTR-PST', capacity: 1000, type: 'kantor', currentItems: 0 },
                        { id: 4, name: 'Gudang Utama', code: 'GDG-01', capacity: 2000, type: 'gudang', currentItems: 0 },
                        { id: 5, name: 'Rak Penyimpanan', code: 'RAK-01', capacity: 200, type: 'rak', currentItems: 0 }
                    ];
                    
                    const savedLocations = storage.get('inventory_locations');
                    setLocations(savedLocations || defaultLocations);
                    
                } catch (error) {
                    console.error('Initialization error:', error);
                    showToast('Error memuat data', 'error');
                } finally {
                    setTimeout(() => setLoading(false), 500);
                }
            };

            // ==================== UTILITY FUNCTIONS ====================
            const showToast = (message, type = 'info') => {
                const id = Date.now();
                setToasts(prev => [...prev, { id, message, type }]);
            };

            const removeToast = (id) => {
                setToasts(prev => prev.filter(toast => toast.id !== id));
            };

            const generateCode = (prefix) => {
                const now = new Date();
                const year = now.getFullYear().toString().slice(-2);
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
                return `${prefix}${year}${month}${day}${random}`;
            };

            const generateBarcode = (code) => {
                // Simple barcode simulation - in real app use barcode library
                return `*${code}*`;
            };

            const saveAllData = () => {
                try {
                    storage.set('inventory_items', items);
                    storage.set('inventory_history', history);
                    storage.set('inventory_suppliers', suppliers);
                    storage.set('inventory_purchase_orders', purchaseOrders);
                    storage.set('inventory_stocktakes', stocktakes);
                    storage.set('inventory_users', users);
                    storage.set('inventory_locations', locations);
                    return true;
                } catch (error) {
                    console.error('Save error:', error);
                    return false;
                }
            };

            const addHistory = (action, data, oldData = null) => {
                const historyEntry = {
                    id: Date.now(),
                    action,
                    data,
                    oldData,
                    user: user?.username || 'System',
                    role: user?.role,
                    timestamp: new Date().toISOString(),
                    ip: 'localhost'
                };
                
                const newHistory = [historyEntry, ...history].slice(0, 1000);
                setHistory(newHistory);
                storage.set('inventory_history', newHistory);
            };

            const checkPermission = (permission) => {
                if (!user) return false;
                if (user.role === 'owner') return true;
                return user.permissions?.includes(permission) || false;
            };

            // ==================== CRUD OPERATIONS ====================
            
            // Items CRUD
            const saveItem = () => {
                try {
                    // Validation
                    if (!formData.nama || !formData.kategori || !formData.jumlah || !formData.satuan || !formData.harga) {
                        showToast('Harap lengkapi semua field yang diperlukan', 'error');
                        return;
                    }

                    const barcode = formData.barcode || generateBarcode(formData.kode || generateCode('INV'));
                    const newItem = {
                        id: formData.id || Date.now(),
                        kode: formData.kode || generateCode('INV'),
                        nama: formData.nama,
                        kategori: formData.kategori,
                        lokasi: formData.lokasi || locations[0]?.name || 'Kantor 1',
                        jumlah: parseFloat(formData.jumlah) || 0,
                        satuan: formData.satuan,
                        harga: parseFloat(formData.harga) || 0,
                        stokMinimal: parseFloat(formData.stokMinimal) || 0,
                        supplierId: formData.supplierId || null,
                        barcode: barcode,
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString(),
                        createdBy: user?.username || 'System'
                    };

                    let newItems;
                    let action;
                    let oldData = null;

                    if (formData.id) {
                        oldData = items.find(item => item.id === formData.id);
                        newItems = items.map(item => 
                            item.id === formData.id ? newItem : item
                        );
                        action = 'UPDATE_ITEM';
                        showToast('‚úÖ Barang berhasil diperbarui', 'success');
                    } else {
                        newItems = [...items, newItem];
                        action = 'CREATE_ITEM';
                        showToast('‚úÖ Barang berhasil ditambahkan', 'success');
                    }

                    setItems(newItems);
                    addHistory(action, newItem, oldData);
                    saveAllData();
                    resetForm('item');
                    setShowItemForm(false);
                } catch (error) {
                    console.error('Save item error:', error);
                    showToast('‚ùå Gagal menyimpan barang', 'error');
                }
            };

            const deleteItem = (id) => {
                if (!window.confirm('Yakin ingin menghapus barang ini?')) return;

                try {
                    const itemToDelete = items.find(item => item.id === id);
                    const newItems = items.filter(item => item.id !== id);

                    setItems(newItems);
                    addHistory('DELETE_ITEM', itemToDelete);
                    saveAllData();
                    showToast('üóëÔ∏è Barang berhasil dihapus', 'success');
                } catch (error) {
                    console.error('Delete item error:', error);
                    showToast('‚ùå Gagal menghapus barang', 'error');
                }
            };

            // Suppliers CRUD
            const saveSupplier = () => {
                try {
                    if (!formData.supplierName || !formData.supplierContact) {
                        showToast('Harap lengkapi nama dan kontak supplier', 'error');
                        return;
                    }

                    const newSupplier = {
                        id: Date.now(),
                        code: generateCode('SUP'),
                        name: formData.supplierName,
                        contact: formData.supplierContact,
                        address: formData.supplierAddress,
                        phone: formData.supplierPhone,
                        email: formData.supplierEmail,
                        createdAt: new Date().toISOString(),
                        createdBy: user?.username
                    };

                    const newSuppliers = [...suppliers, newSupplier];
                    setSuppliers(newSuppliers);
                    addHistory('CREATE_SUPPLIER', newSupplier);
                    saveAllData();
                    showToast('‚úÖ Supplier berhasil ditambahkan', 'success');
                    resetForm('supplier');
                    setShowSupplierForm(false);
                } catch (error) {
                    console.error('Save supplier error:', error);
                    showToast('‚ùå Gagal menyimpan supplier', 'error');
                }
            };

            // Purchase Orders CRUD
            const savePurchaseOrder = () => {
                try {
                    if (!formData.poSupplierId || formData.poItems.length === 0) {
                        showToast('Harap pilih supplier dan tambahkan item', 'error');
                        return;
                    }

                    const newPO = {
                        id: Date.now(),
                        poNumber: formData.poNumber || generateCode('PO'),
                        supplierId: formData.poSupplierId,
                        items: formData.poItems,
                        date: formData.poDate || new Date().toISOString(),
                        status: formData.poStatus,
                        total: formData.poItems.reduce((sum, item) => sum + (item.quantity * item.price), 0),
                        createdAt: new Date().toISOString(),
                        createdBy: user?.username
                    };

                    const newPOs = [...purchaseOrders, newPO];
                    setPurchaseOrders(newPOs);
                    addHistory('CREATE_PO', newPO);
                    saveAllData();
                    showToast('‚úÖ Purchase Order berhasil dibuat', 'success');
                    resetForm('purchase');
                    setShowPOForm(false);
                } catch (error) {
                    console.error('Save PO error:', error);
                    showToast('‚ùå Gagal membuat Purchase Order', 'error');
                }
            };

            // Stocktake CRUD
            const saveStocktake = () => {
                try {
                    if (formData.stItems.length === 0) {
                        showToast('Harap tambahkan item untuk stock opname', 'error');
                        return;
                    }

                    const newStocktake = {
                        id: Date.now(),
                        date: formData.stDate || new Date().toISOString(),
                        items: formData.stItems,
                        notes: formData.stNotes,
                        createdBy: user?.username,
                        createdAt: new Date().toISOString()
                    };

                    // Update actual stock based on stocktake
                    formData.stItems.forEach(stItem => {
                        const itemIndex = items.findIndex(item => item.id === stItem.itemId);
                        if (itemIndex !== -1) {
                            const difference = stItem.actual - items[itemIndex].jumlah;
                            if (difference !== 0) {
                                const updatedItems = [...items];
                                updatedItems[itemIndex] = {
                                    ...updatedItems[itemIndex],
                                    jumlah: stItem.actual,
                                    updatedAt: new Date().toISOString()
                                };
                                setItems(updatedItems);
                                
                                // Add adjustment history
                                addHistory('STOCK_ADJUSTMENT', {
                                    itemId: stItem.itemId,
                                    itemName: stItem.itemName,
                                    oldQuantity: items[itemIndex].jumlah,
                                    newQuantity: stItem.actual,
                                    difference: difference,
                                    reason: 'Stock Opname'
                                });
                            }
                        }
                    });

                    const newStocktakes = [...stocktakes, newStocktake];
                    setStocktakes(newStocktakes);
                    addHistory('CREATE_STOCKTAKE', newStocktake);
                    saveAllData();
                    showToast('‚úÖ Stock Opname berhasil disimpan', 'success');
                    resetForm('stocktake');
                    setShowStocktakeForm(false);
                } catch (error) {
                    console.error('Save stocktake error:', error);
                    showToast('‚ùå Gagal menyimpan Stock Opname', 'error');
                }
            };

            // Users CRUD
            const saveUser = () => {
                try {
                    if (!formData.userUsername || !formData.userPassword) {
                        showToast('Harap lengkapi username dan password', 'error');
                        return;
                    }

                    const newUser = {
                        id: Date.now(),
                        username: formData.userUsername,
                        password: formData.userPassword, // In real app, hash this!
                        role: formData.userRole,
                        permissions: formData.userPermissions,
                        createdAt: new Date().toISOString(),
                        createdBy: user?.username
                    };

                    const newUsers = [...users, newUser];
                    setUsers(newUsers);
                    addHistory('CREATE_USER', { ...newUser, password: '***' });
                    saveAllData();
                    showToast('‚úÖ User berhasil ditambahkan', 'success');
                    resetForm('user');
                    setShowUserForm(false);
                } catch (error) {
                    console.error('Save user error:', error);
                    showToast('‚ùå Gagal menyimpan user', 'error');
                }
            };

            // Locations CRUD
            const saveLocation = () => {
                try {
                    if (!formData.locationName || !formData.locationCode) {
                        showToast('Harap lengkapi nama dan kode lokasi', 'error');
                        return;
                    }

                    const newLocation = {
                        id: Date.now(),
                        name: formData.locationName,
                        code: formData.locationCode,
                        capacity: parseInt(formData.locationCapacity) || 0,
                        type: formData.locationType,
                        currentItems: 0,
                        createdAt: new Date().toISOString(),
                        createdBy: user?.username
                    };

                    const newLocations = [...locations, newLocation];
                    setLocations(newLocations);
                    addHistory('CREATE_LOCATION', newLocation);
                    saveAllData();
                    showToast('‚úÖ Lokasi berhasil ditambahkan', 'success');
                    resetForm('location');
                    setShowLocationForm(false);
                } catch (error) {
                    console.error('Save location error:', error);
                    showToast('‚ùå Gagal menyimpan lokasi', 'error');
                }
            };

            // Reset forms
            const resetForm = (type) => {
                const defaultForm = {
                    id: null,
                    kode: generateCode('INV'),
                    nama: '',
                    kategori: '',
                    lokasi: '',
                    jumlah: '',
                    satuan: '',
                    harga: '',
                    stokMinimal: '',
                    supplierId: '',
                    barcode: '',
                    supplierName: '',
                    supplierContact: '',
                    supplierAddress: '',
                    supplierPhone: '',
                    supplierEmail: '',
                    poNumber: generateCode('PO'),
                    poSupplierId: '',
                    poItems: [],
                    poDate: new Date().toISOString().split('T')[0],
                    poStatus: 'pending',
                    stDate: new Date().toISOString().split('T')[0],
                    stItems: [],
                    stNotes: '',
                    userUsername: '',
                    userPassword: '',
                    userRole: 'staff',
                    userPermissions: [],
                    locationName: '',
                    locationCode: generateCode('LOC'),
                    locationCapacity: '',
                    locationType: 'kantor'
                };

                setFormData(defaultForm);
            };

            // ==================== BATCH OPERATIONS ====================
            const bulkUpdate = (itemIds, updates) => {
                try {
                    const newItems = items.map(item => 
                        itemIds.includes(item.id) ? { ...item, ...updates, updatedAt: new Date().toISOString() } : item
                    );
                    
                    setItems(newItems);
                    addHistory('BULK_UPDATE', { itemIds, updates });
                    saveAllData();
                    showToast(`‚úÖ ${itemIds.length} item berhasil diperbarui`, 'success');
                } catch (error) {
                    console.error('Bulk update error:', error);
                    showToast('‚ùå Gagal melakukan bulk update', 'error');
                }
            };

            const bulkDelete = (itemIds) => {
                if (!window.confirm(`Yakin ingin menghapus ${itemIds.length} item?`)) return;

                try {
                    const itemsToDelete = items.filter(item => itemIds.includes(item.id));
                    const newItems = items.filter(item => !itemIds.includes(item.id));
                    
                    setItems(newItems);
                    addHistory('BULK_DELETE', itemsToDelete);
                    saveAllData();
                    showToast(`üóëÔ∏è ${itemIds.length} item berhasil dihapus`, 'success');
                } catch (error) {
                    console.error('Bulk delete error:', error);
                    showToast('‚ùå Gagal menghapus item', 'error');
                }
            };

            // ==================== IMPORT/EXPORT ====================
            const exportToCSV = (data, filename) => {
                try {
                    if (data.length === 0) {
                        showToast('Tidak ada data untuk diexport', 'warning');
                        return;
                    }

                    const headers = Object.keys(data[0]).join(',');
                    const rows = data.map(item => 
                        Object.values(item).map(val => 
                            typeof val === 'string' ? `"${val.replace(/"/g, '""')}"` : val
                        ).join(',')
                    ).join('\n');
                    
                    const csv = `${headers}\n${rows}`;
                    const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${filename}-${new Date().toISOString().split('T')[0]}.csv`;
                    a.click();
                    
                    showToast(`‚úÖ Data berhasil diexport ke ${filename}.csv`, 'success');
                } catch (error) {
                    console.error('Export error:', error);
                    showToast('‚ùå Gagal mengexport data', 'error');
                }
            };

            const importFromCSV = (event, type) => {
                try {
                    const file = event.target.files[0];
                    if (!file) return;

                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const content = e.target.result;
                            const lines = content.split('\n');
                            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
                            const importedData = lines.slice(1).filter(line => line.trim()).map(line => {
                                const values = line.split(',').map(v => v.trim().replace(/^"|"$/g, ''));
                                const obj = {};
                                headers.forEach((header, index) => {
                                    obj[header] = values[index] || '';
                                });
                                return obj;
                            });

                            switch(type) {
                                case 'items':
                                    const newItems = importedData.map(item => ({
                                        id: Date.now() + Math.random(),
                                        kode: item.kode || generateCode('INV'),
                                        nama: item.nama,
                                        kategori: item.kategori,
                                        lokasi: item.lokasi || 'Kantor 1',
                                        jumlah: parseFloat(item.jumlah) || 0,
                                        satuan: item.satuan,
                                        harga: parseFloat(item.harga) || 0,
                                        stokMinimal: parseFloat(item.stokMinimal) || 0,
                                        barcode: generateBarcode(item.kode),
                                        createdAt: new Date().toISOString(),
                                        updatedAt: new Date().toISOString(),
                                        createdBy: user?.username
                                    }));
                                    setItems(prev => [...prev, ...newItems]);
                                    addHistory('IMPORT_ITEMS', { count: newItems.length });
                                    showToast(`‚úÖ ${newItems.length} item berhasil diimport`, 'success');
                                    break;
                                    
                                case 'suppliers':
                                    const newSuppliers = importedData.map(sup => ({
                                        id: Date.now() + Math.random(),
                                        code: sup.code || generateCode('SUP'),
                                        name: sup.name,
                                        contact: sup.contact,
                                        address: sup.address,
                                        phone: sup.phone,
                                        email: sup.email,
                                        createdAt: new Date().toISOString(),
                                        createdBy: user?.username
                                    }));
                                    setSuppliers(prev => [...prev, ...newSuppliers]);
                                    showToast(`‚úÖ ${newSuppliers.length} supplier berhasil diimport`, 'success');
                                    break;
                            }
                            
                            saveAllData();
                        } catch (parseError) {
                            console.error('Parse error:', parseError);
                            showToast('‚ùå Format file CSV tidak valid', 'error');
                        }
                    };
                    
                    reader.readAsText(file);
                } catch (error) {
                    console.error('Import error:', error);
                    showToast('‚ùå Gagal mengimport data', 'error');
                }
            };

            // ==================== BACKUP & RESTORE ====================
            const createBackup = () => {
                try {
                    const backupData = {
                        items,
                        suppliers,
                        purchaseOrders,
                        stocktakes,
                        users,
                        locations,
                        history: history.slice(0, 500), // Limit history in backup
                        backupDate: new Date().toISOString(),
                        backupBy: user?.username,
                        version: '2.0'
                    };

                    const blob = new Blob([JSON.stringify(backupData, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `backup-inventori-${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    
                    showToast('‚úÖ Backup berhasil dibuat', 'success');
                } catch (error) {
                    console.error('Backup error:', error);
                    showToast('‚ùå Gagal membuat backup', 'error');
                }
            };

            const restoreBackup = (event) => {
                try {
                    const file = event.target.files[0];
                    if (!file) return;

                    if (!window.confirm('Restore akan mengganti semua data saat ini. Lanjutkan?')) {
                        return;
                    }

                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const backupData = JSON.parse(e.target.result);
                            
                            // Validate backup format
                            if (!backupData.items || !backupData.version) {
                                throw new Error('Format backup tidak valid');
                            }

                            // Restore data
                            setItems(backupData.items || []);
                            setSuppliers(backupData.suppliers || []);
                            setPurchaseOrders(backupData.purchaseOrders || []);
                            setStocktakes(backupData.stocktakes || []);
                            setUsers(backupData.users || []);
                            setLocations(backupData.locations || []);
                            setHistory(backupData.history || []);
                            
                            saveAllData();
                            showToast('‚úÖ Restore berhasil dilakukan', 'success');
                            addHistory('SYSTEM_RESTORE', { fromBackup: backupData.backupDate });
                        } catch (parseError) {
                            console.error('Restore parse error:', parseError);
                            showToast('‚ùå File backup tidak valid', 'error');
                        }
                    };
                    
                    reader.readAsText(file);
                } catch (error) {
                    console.error('Restore error:', error);
                    showToast('‚ùå Gagal melakukan restore', 'error');
                }
            };

            // ==================== FILTER & SEARCH ====================
            const filteredItems = items.filter(item => {
                // Search term
                if (searchTerm) {
                    const searchLower = searchTerm.toLowerCase();
                    const matchesSearch = 
                        item.nama?.toLowerCase().includes(searchLower) ||
                        item.kode?.toLowerCase().includes(searchLower) ||
                        item.kategori?.toLowerCase().includes(searchLower) ||
                        item.lokasi?.toLowerCase().includes(searchLower) ||
                        item.barcode?.includes(searchTerm);
                    if (!matchesSearch) return false;
                }

                // Filters
                if (filters.kategori && item.kategori !== filters.kategori) return false;
                if (filters.lokasi && item.lokasi !== filters.lokasi) return false;
                if (filters.status === 'low' && (!item.stokMinimal || item.jumlah > item.stokMinimal)) return false;
                if (filters.status === 'out' && item.jumlah > 0) return false;

                return true;
            });

            // Paginate filtered items
            const indexOfLastItem = currentPage * itemsPerPage;
            const indexOfFirstItem = indexOfLastItem - itemsPerPage;
            const currentItems = filteredItems.slice(indexOfFirstItem, indexOfLastItem);

            // ==================== STATISTICS ====================
            const statistics = {
                totalItems: items.length,
                totalValue: items.reduce((sum, item) => sum + (item.jumlah * item.harga), 0),
                lowStockItems: items.filter(item => item.stokMinimal && item.jumlah <= item.stokMinimal).length,
                outOfStockItems: items.filter(item => item.jumlah === 0).length,
                categoriesCount: new Set(items.map(item => item.kategori)).size,
                locationsCount: locations.length,
                suppliersCount: suppliers.length,
                pendingPOs: purchaseOrders.filter(po => po.status === 'pending').length,
                recentStocktakes: stocktakes.filter(st => 
                    new Date(st.date) > new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)
                ).length
            };

            const lowStockItems = items.filter(item => 
                item.stokMinimal && item.jumlah <= item.stokMinimal
            );

            const fastMovingItems = [...items]
                .sort((a, b) => b.jumlah - a.jumlah)
                .slice(0, 10);

            // ==================== AUTH FUNCTIONS ====================
            const handleLogin = (userData) => {
                setUser(userData);
                storage.set('inventory_user', userData);
                showToast(`üëã Selamat datang, ${userData.username}!`, 'success');
            };

            const handleLogout = () => {
                if (window.confirm('Yakin ingin logout?')) {
                    setUser(null);
                    storage.remove('inventory_user');
                    showToast('Berhasil logout', 'info');
                }
            };

            // ==================== RENDER COMPONENTS ====================
            
            // Dashboard
            const renderDashboard = () => {
                const statCards = [
                    { 
                        label: 'Total Barang', 
                        value: statistics.totalItems, 
                        icon: Icon.Package, 
                        color: 'blue',
                        change: '+12% dari bulan lalu'
                    },
                    { 
                        label: 'Total Nilai Inventori', 
                        value: `Rp ${statistics.totalValue.toLocaleString('id-ID')}`, 
                        icon: Icon.Dollar, 
                        color: 'green',
                        change: '+8% dari bulan lalu'
                    },
                    { 
                        label: 'Stok Rendah', 
                        value: statistics.lowStockItems, 
                        icon: Icon.Alert, 
                        color: 'red',
                        change: 'Perlu restok segera'
                    },
                    { 
                        label: 'Supplier', 
                        value: statistics.suppliersCount, 
                        icon: Icon.Supplier, 
                        color: 'purple',
                        change: `${statistics.pendingPOs} PO pending`
                    },
                    { 
                        label: 'Lokasi', 
                        value: statistics.locationsCount, 
                        icon: Icon.Location, 
                        color: 'indigo',
                        change: `${locations.reduce((sum, loc) => sum + loc.currentItems, 0)} item tersimpan`
                    },
                    { 
                        label: 'Stock Opname (30 hari)', 
                        value: statistics.recentStocktakes, 
                        icon: Icon.Stocktake, 
                        color: 'yellow',
                        change: 'Terakhir: ' + (stocktakes[0]?.date ? new Date(stocktakes[0].date).toLocaleDateString('id-ID') : '-')
                    }
                ];

                // Stock level chart data
                const stockLevels = [
                    { level: 'Normal', count: items.filter(item => item.jumlah > (item.stokMinimal || 0)).length, color: 'bg-green-500' },
                    { level: 'Rendah', count: statistics.lowStockItems, color: 'bg-yellow-500' },
                    { level: 'Habis', count: statistics.outOfStockItems, color: 'bg-red-500' }
                ];

                return (
                    <div className="animate-fadeIn">
                        <NavigationButtons />
                        
                        <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-8">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Dashboard Inventori Aset</h1>
                                <p className="text-gray-600">Ringkasan lengkap sistem inventori aset RAS</p>
                            </div>
                            <div className="flex items-center gap-4">
                                <span className="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium">
                                    {user?.role === 'owner' ? 'Owner' : user?.role === 'admin' ? 'Admin' : 'Staff'}
                                </span>
                                <span className="text-gray-700">{user?.username}</span>
                            </div>
                        </div>

                        {/* Stats Grid */}
                        <div className="dashboard-grid mb-8">
                            {statCards.map((stat, index) => (
                                <div key={index} className="bg-white p-6 rounded-xl shadow border hover:shadow-md transition">
                                    <div className="flex items-center justify-between mb-4">
                                        <div className={`w-12 h-12 bg-${stat.color}-100 rounded-xl flex items-center justify-center`}>
                                            <stat.icon />
                                        </div>
                                        <span className="text-sm text-gray-500">{stat.change}</span>
                                    </div>
                                    <h3 className="text-2xl font-bold text-gray-800 mb-1">{stat.value}</h3>
                                    <p className="text-gray-600">{stat.label}</p>
                                </div>
                            ))}
                        </div>

                        {/* Stock Levels & Fast Moving Items */}
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                            {/* Stock Levels */}
                            <div className="bg-white p-6 rounded-xl shadow border">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4">Level Stok</h3>
                                <div className="space-y-4">
                                    {stockLevels.map((level, index) => {
                                        const percentage = items.length > 0 ? (level.count / items.length * 100).toFixed(1) : 0;
                                        return (
                                            <div key={index} className="space-y-2">
                                                <div className="flex justify-between text-sm">
                                                    <span className="text-gray-700">{level.level}</span>
                                                    <span className="font-semibold">{level.count} ({percentage}%)</span>
                                                </div>
                                                <div className="w-full bg-gray-200 rounded-full h-2">
                                                    <div 
                                                        className={`${level.color} h-2 rounded-full`}
                                                        style={{ width: `${percentage}%` }}
                                                    ></div>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>

                            {/* Fast Moving Items */}
                            <div className="bg-white p-6 rounded-xl shadow border">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4">Barang Paling Banyak</h3>
                                <div className="space-y-3">
                                    {fastMovingItems.slice(0, 5).map((item, index) => (
                                        <div key={item.id} className="flex items-center justify-between p-3 bg-gray-50 rounded">
                                            <div className="flex-1">
                                                <p className="font-medium text-gray-800">{item.nama}</p>
                                                <p className="text-sm text-gray-600">{item.kode} ‚Ä¢ {item.lokasi}</p>
                                            </div>
                                            <div className="text-right">
                                                <p className="font-bold text-blue-600">{item.jumlah} {item.satuan}</p>
                                                <p className="text-sm text-gray-600">Rp {item.harga.toLocaleString('id-ID')}</p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* Recent Activity & Low Stock Warning */}
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            {/* Low Stock Warning */}
                            {lowStockItems.length > 0 && (
                                <div className="bg-red-50 border border-red-200 rounded-xl p-6">
                                    <div className="flex items-center gap-3 mb-4">
                                        <div className="w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center">
                                            <Icon.Alert />
                                        </div>
                                        <div>
                                            <h3 className="font-bold text-red-800">Peringatan Stok Rendah!</h3>
                                            <p className="text-red-700">{lowStockItems.length} item perlu restok</p>
                                        </div>
                                    </div>
                                    <div className="space-y-2">
                                        {lowStockItems.slice(0, 3).map(item => (
                                            <div key={item.id} className="bg-white p-3 rounded border border-red-100">
                                                <div className="flex justify-between">
                                                    <span className="font-medium">{item.nama}</span>
                                                    <span className="text-red-600 font-bold">{item.jumlah} {item.satuan}</span>
                                                </div>
                                                <div className="flex items-center gap-2 mt-1 text-sm text-gray-600">
                                                    <Icon.Location />
                                                    <span>{item.lokasi}</span>
                                                    <span className="ml-auto">Min: {item.stokMinimal}</span>
                                                </div>
                                            </div>
                                        ))}
                                        {lowStockItems.length > 3 && (
                                            <button 
                                                onClick={() => setActiveTab('inventory')}
                                                className="w-full text-center text-red-600 font-medium py-2"
                                            >
                                                Lihat {lowStockItems.length - 3} lainnya ‚Üí
                                            </button>
                                        )}
                                    </div>
                                </div>
                            )}

                            {/* Recent Activity */}
                            <div className="bg-white p-6 rounded-xl shadow border">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4">Aktivitas Terbaru</h3>
                                <div className="space-y-3">
                                    {history.slice(0, 5).map(record => (
                                        <div key={record.id} className="flex items-center gap-3 p-3 bg-gray-50 rounded">
                                            <div className={`w-2 h-2 rounded-full ${
                                                record.action.includes('CREATE') ? 'bg-green-500' :
                                                record.action.includes('UPDATE') ? 'bg-blue-500' :
                                                record.action.includes('DELETE') ? 'bg-red-500' : 'bg-gray-500'
                                            }`}></div>
                                            <div className="flex-1">
                                                <p className="font-medium text-gray-800">
                                                    {record.action.replace('_', ' ')}
                                                </p>
                                                <p className="text-xs text-gray-600">
                                                    {record.user} ‚Ä¢ {new Date(record.timestamp).toLocaleString('id-ID')}
                                                </p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            // Inventory Management
            const renderInventory = () => {
                return (
                    <div className="animate-fadeIn">
                        <NavigationButtons />
                        
                        <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-8">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Manajemen Inventori Aset</h1>
                                <p className="text-gray-600">Kelola semua barang dalam sistem</p>
                            </div>
                            
                            <div className="flex flex-col sm:flex-row gap-2">
                                <div className="relative">
                                    <Icon.Search />
                                    <input
                                        type="text"
                                        placeholder="Cari barang, kode, atau barcode..."
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                        className="w-full sm:w-64 pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                    />
                                </div>
                                <button
                                    onClick={() => {
                                        resetForm('item');
                                        setShowItemForm(true);
                                    }}
                                    className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2"
                                >
                                    <Icon.Add />
                                    Tambah Barang
                                </button>
                                <button
                                    onClick={() => exportToCSV(items, 'inventory')}
                                    className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2"
                                >
                                    <Icon.Download />
                                    Export
                                </button>
                            </div>
                        </div>

                        {/* Filters */}
                        <div className="bg-white p-4 rounded-xl shadow border mb-6">
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <select
                                    value={filters.kategori}
                                    onChange={(e) => setFilters({...filters, kategori: e.target.value})}
                                    className="px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                >
                                    <option value="">Semua Kategori</option>
                                    {categories.map(cat => (
                                        <option key={cat} value={cat}>{cat}</option>
                                    ))}
                                </select>
                                
                                <select
                                    value={filters.lokasi}
                                    onChange={(e) => setFilters({...filters, lokasi: e.target.value})}
                                    className="px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                >
                                    <option value="">Semua Lokasi</option>
                                    {locations.map(loc => (
                                        <option key={loc.id} value={loc.name}>{loc.name}</option>
                                    ))}
                                </select>
                                
                                <select
                                    value={filters.status}
                                    onChange={(e) => setFilters({...filters, status: e.target.value})}
                                    className="px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"
                                >
                                    <option value="">Semua Status</option>
                                    <option value="low">Stok Rendah</option>
                                    <option value="out">Stok Habis</option>
                                </select>
                                
                                <div className="flex gap-2">
                                    <button
                                        onClick={() => setFilters({ kategori: '', lokasi: '', status: '' })}
                                        className="flex-1 px-3 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200"
                                    >
                                        Reset Filter
                                    </button>
                                    <label className="flex-1 px-3 py-2 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 cursor-pointer text-center">
                                        <Icon.Upload />
                                        <input
                                            type="file"
                                            accept=".csv"
                                            onChange={(e) => importFromCSV(e, 'items')}
                                            className="hidden"
                                        />
                                        Import CSV
                                    </label>
                                </div>
                            </div>
                        </div>

                        {/* Items Table */}
                        <div className="bg-white rounded-xl shadow border overflow-hidden">
                            <div className="table-container">
                                <table className="w-full min-w-full">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Kode</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Nama Barang</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Kategori</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Lokasi</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Stok</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Harga</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Total</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Barcode</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Status</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-200">
                                        {currentItems.length === 0 ? (
                                            <tr>
                                                <td colSpan="10" className="px-6 py-12 text-center text-gray-500">
                                                    {searchTerm ? 'Tidak ada barang yang ditemukan' : 'Belum ada data barang. Mulai dengan menambahkan barang baru.'}
                                                </td>
                                            </tr>
                                        ) : (
                                            currentItems.map(item => {
                                                const total = item.jumlah * item.harga;
                                                const isLowStock = item.stokMinimal && item.jumlah <= item.stokMinimal;
                                                const isOutOfStock = item.jumlah === 0;
                                                const status = isOutOfStock ? 'Habis' : isLowStock ? 'Rendah' : 'Normal';
                                                const statusColor = isOutOfStock ? 'bg-red-100 text-red-800' : 
                                                                 isLowStock ? 'bg-yellow-100 text-yellow-800' : 
                                                                 'bg-green-100 text-green-800';

                                                return (
                                                    <tr key={item.id} className="hover:bg-gray-50">
                                                        <td className="px-6 py-4">
                                                            <div className="font-mono text-sm font-semibold text-blue-600">
                                                                {item.kode}
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <div>
                                                                <p className="font-semibold text-gray-800">{item.nama}</p>
                                                                <p className="text-sm text-gray-600">
                                                                    {new Date(item.createdAt).toLocaleDateString('id-ID')}
                                                                </p>
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <span className="px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs">
                                                                {item.kategori}
                                                            </span>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <div className="flex items-center gap-2">
                                                                <Icon.Location />
                                                                <span className="text-gray-700">{item.lokasi}</span>
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <div>
                                                                <p className={`font-semibold ${isOutOfStock ? 'text-red-600' : isLowStock ? 'text-yellow-600' : 'text-gray-800'}`}>
                                                                    {item.jumlah} {item.satuan}
                                                                </p>
                                                                {item.stokMinimal > 0 && (
                                                                    <p className="text-xs text-gray-500">
                                                                        Minimal: {item.stokMinimal}
                                                                    </p>
                                                                )}
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <p className="text-gray-800">Rp {item.harga.toLocaleString('id-ID')}</p>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <p className="font-bold text-green-600">
                                                                Rp {total.toLocaleString('id-ID')}
                                                            </p>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <div className="text-center">
                                                                <div className="barcode-preview text-sm">{item.barcode}</div>
                                                                <button 
                                                                    onClick={() => {
                                                                        // Simulate barcode printing
                                                                        window.open(`data:text/html,<html><body style="font-family: 'Libre Barcode 128'; font-size: 48px; text-align: center; padding: 20px;">${item.barcode}<br>${item.kode}<br>${item.nama}</body></html>`, '_blank');
                                                                    }}
                                                                    className="text-xs text-blue-600 hover:text-blue-800 mt-1"
                                                                >
                                                                    Print
                                                                </button>
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <span className={`px-2 py-1 rounded text-xs ${statusColor}`}>
                                                                {status}
                                                            </span>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <div className="flex gap-2">
                                                                <button
                                                                    onClick={() => {
                                                                        setFormData({
                                                                            ...formData,
                                                                            id: item.id,
                                                                            kode: item.kode,
                                                                            nama: item.nama,
                                                                            kategori: item.kategori,
                                                                            lokasi: item.lokasi,
                                                                            jumlah: item.jumlah.toString(),
                                                                            satuan: item.satuan,
                                                                            harga: item.harga.toString(),
                                                                            stokMinimal: item.stokMinimal?.toString() || '',
                                                                            barcode: item.barcode
                                                                        });
                                                                        setShowItemForm(true);
                                                                    }}
                                                                    className="p-1 text-blue-600 hover:bg-blue-50 rounded"
                                                                    title="Edit"
                                                                >
                                                                    <Icon.Edit />
                                                                </button>
                                                                <button
                                                                    onClick={() => deleteItem(item.id)}
                                                                    className="p-1 text-red-600 hover:bg-red-50 rounded"
                                                                    title="Hapus"
                                                                >
                                                                    <Icon.Delete />
                                                                </button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                );
                                            })
                                        )}
                                    </tbody>
                                </table>
                            </div>
                            
                            {/* Pagination */}
                            <Pagination
                                currentPage={currentPage}
                                totalItems={filteredItems.length}
                                itemsPerPage={itemsPerPage}
                                onPageChange={handlePageChange}
                                onItemsPerPageChange={handleItemsPerPageChange}
                            />
                        </div>
                    </div>
                );
            };

            // Suppliers Management
            const renderSuppliers = () => {
                if (!checkPermission('manage_suppliers') && user?.role !== 'owner') {
                    return (
                        <div className="text-center py-12">
                            <p className="text-gray-500">Anda tidak memiliki akses ke halaman ini.</p>
                        </div>
                    );
                }

                return (
                    <div className="animate-fadeIn">
                        <NavigationButtons />
                        
                        <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-8">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Manajemen Supplier</h1>
                                <p className="text-gray-600">Kelola data supplier dan vendor</p>
                            </div>
                            
                            <div className="flex gap-2">
                                <button
                                    onClick={() => {
                                        resetForm('supplier');
                                        setShowSupplierForm(true);
                                    }}
                                    className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2"
                                >
                                    <Icon.Add />
                                    Tambah Supplier
                                </button>
                                <button
                                    onClick={() => exportToCSV(suppliers, 'suppliers')}
                                    className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2"
                                >
                                    <Icon.Download />
                                    Export
                                </button>
                            </div>
                        </div>

                        {/* Suppliers Grid */}
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {suppliers.length === 0 ? (
                                <div className="col-span-3 text-center py-12 text-gray-500">
                                    Belum ada data supplier
                                </div>
                            ) : (
                                suppliers.map(supplier => (
                                    <div key={supplier.id} className="bg-white p-6 rounded-xl shadow border hover:shadow-md transition">
                                        <div className="flex items-start justify-between mb-4">
                                            <div>
                                                <h3 className="text-lg font-semibold text-gray-800">{supplier.name}</h3>
                                                <p className="text-sm text-blue-600 font-mono">{supplier.code}</p>
                                            </div>
                                            <span className="px-2 py-1 bg-green-100 text-green-800 rounded text-xs">
                                                Active
                                            </span>
                                        </div>
                                        
                                        <div className="space-y-2 mb-4">
                                            <div className="flex items-center gap-2 text-gray-600">
                                                <span>üë§</span>
                                                <span>{supplier.contact}</span>
                                            </div>
                                            {supplier.phone && (
                                                <div className="flex items-center gap-2 text-gray-600">
                                                    <span>üìû</span>
                                                    <span>{supplier.phone}</span>
                                                </div>
                                            )}
                                            {supplier.email && (
                                                <div className="flex items-center gap-2 text-gray-600">
                                                    <span>üìß</span>
                                                    <span className="text-sm">{supplier.email}</span>
                                                </div>
                                            )}
                                        </div>
                                        
                                        {supplier.address && (
                                            <p className="text-sm text-gray-500 mb-4">{supplier.address}</p>
                                        )}
                                        
                                        <div className="flex gap-2">
                                            <button
                                                onClick={() => {
                                                    // Quick order button
                                                    setFormData(prev => ({
                                                        ...prev,
                                                        poSupplierId: supplier.id,
                                                        poSupplierName: supplier.name
                                                    }));
                                                    setActiveTab('purchase');
                                                }}
                                                className="flex-1 bg-blue-50 text-blue-700 px-3 py-2 rounded hover:bg-blue-100 text-sm"
                                            >
                                                Buat PO
                                            </button>
                                            <button 
                                                onClick={() => {
                                                    // Edit supplier functionality
                                                    alert('Fitur edit supplier akan segera tersedia!');
                                                }}
                                                className="p-2 text-gray-400 hover:text-gray-600"
                                            >
                                                <Icon.Edit />
                                            </button>
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>
                    </div>
                );
            };

            // Purchase Orders
            const renderPurchaseOrders = () => {
                return (
                    <div className="animate-fadeIn">
                        <NavigationButtons />
                        
                        <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-8">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Purchase Orders</h1>
                                <p className="text-gray-600">Kelola pemesanan barang dari supplier</p>
                            </div>
                            
                            <div className="flex gap-2">
                                <button
                                    onClick={() => {
                                        resetForm('purchase');
                                        setShowPOForm(true);
                                    }}
                                    className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2"
                                >
                                    <Icon.Add />
                                    Buat PO Baru
                                </button>
                            </div>
                        </div>

                        {/* POs Table */}
                        <div className="bg-white rounded-xl shadow border overflow-hidden">
                            <div className="table-container">
                                <table className="w-full min-w-full">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">No. PO</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Supplier</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Tanggal</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Jumlah Item</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Total</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Status</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-200">
                                        {purchaseOrders.length === 0 ? (
                                            <tr>
                                                <td colSpan="7" className="px-6 py-12 text-center text-gray-500">
                                                    Belum ada Purchase Order
                                                </td>
                                            </tr>
                                        ) : (
                                            purchaseOrders.map(po => {
                                                const supplier = suppliers.find(s => s.id === po.supplierId);
                                                const statusConfig = poStatuses.find(s => s.value === po.status) || poStatuses[0];
                                                
                                                return (
                                                    <tr key={po.id} className="hover:bg-gray-50">
                                                        <td className="px-6 py-4">
                                                            <div className="font-mono font-semibold text-blue-600">
                                                                {po.poNumber}
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <div className="font-medium text-gray-800">
                                                                {supplier?.name || 'Unknown Supplier'}
                                                            </div>
                                                            <div className="text-sm text-gray-600">
                                                                {supplier?.contact || ''}
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <div className="text-gray-800">
                                                                {new Date(po.date).toLocaleDateString('id-ID')}
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <div className="text-gray-800">
                                                                {po.items?.length || 0} item
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <div className="font-bold text-green-600">
                                                                Rp {po.total?.toLocaleString('id-ID') || '0'}
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <span className={`px-2 py-1 rounded text-xs bg-${statusConfig.color}-100 text-${statusConfig.color}-800`}>
                                                                {statusConfig.label}
                                                            </span>
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <div className="flex gap-2">
                                                                <button
                                                                    onClick={() => {
                                                                        // View PO details
                                                                        alert(`Detail PO: ${po.poNumber}\nSupplier: ${supplier?.name}\nTotal: Rp ${po.total?.toLocaleString('id-ID')}\nStatus: ${statusConfig.label}`);
                                                                    }}
                                                                    className="px-3 py-1 bg-blue-50 text-blue-700 rounded text-sm hover:bg-blue-100"
                                                                >
                                                                    Lihat
                                                                </button>
                                                                {po.status === 'pending' && (
                                                                    <button
                                                                        onClick={() => {
                                                                            if (window.confirm('Update status PO menjadi "Dipesan"?')) {
                                                                                // Update PO status
                                                                                const updatedPOs = purchaseOrders.map(p => 
                                                                                    p.id === po.id ? { ...p, status: 'ordered' } : p
                                                                                );
                                                                                setPurchaseOrders(updatedPOs);
                                                                                saveAllData();
                                                                                showToast('Status PO berhasil diperbarui', 'success');
                                                                            }
                                                                        }}
                                                                        className="px-3 py-1 bg-green-50 text-green-700 rounded text-sm hover:bg-green-100"
                                                                    >
                                                                        Approve
                                                                    </button>
                                                                )}
                                                            </div>
                                                        </td>
                                                    </tr>
                                                );
                                            })
                                        )}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            };

            // Stocktake
            const renderStocktake = () => {
                if (!checkPermission('stocktake') && user?.role !== 'owner') {
                    return (
                        <div className="text-center py-12">
                            <p className="text-gray-500">Anda tidak memiliki akses ke halaman ini.</p>
                        </div>
                    );
                }

                return (
                    <div className="animate-fadeIn">
                        <NavigationButtons />
                        
                        <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-8">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Stock Opname</h1>
                                <p className="text-gray-600">Lakukan penghitungan stok fisik dan adjustment</p>
                            </div>
                            
                            <div className="flex gap-2">
                                <button
                                    onClick={() => {
                                        resetForm('stocktake');
                                        // Pre-populate with current items
                                        const stItems = items.slice(0, 10).map(item => ({
                                            itemId: item.id,
                                            itemName: item.nama,
                                            itemCode: item.kode,
                                            systemQty: item.jumlah,
                                            actual: item.jumlah, // Start with system quantity
                                            difference: 0,
                                            notes: ''
                                        }));
                                        setFormData(prev => ({ ...prev, stItems }));
                                        setShowStocktakeForm(true);
                                    }}
                                    className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2"
                                >
                                    <Icon.Add />
                                    Stock Opname Baru
                                </button>
                            </div>
                        </div>

                        {/* Recent Stocktakes */}
                        <div className="mb-8">
                            <h3 className="text-lg font-semibold text-gray-800 mb-4">Riwayat Stock Opname</h3>
                            <div className="bg-white rounded-xl shadow border overflow-hidden">
                                <div className="table-container">
                                    <table className="w-full min-w-full">
                                        <thead className="bg-gray-50">
                                            <tr>
                                                <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Tanggal</th>
                                                <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Jumlah Item</th>
                                                <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Selisih</th>
                                                <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Dilakukan Oleh</th>
                                                <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Catatan</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-200">
                                            {stocktakes.length === 0 ? (
                                                <tr>
                                                    <td colSpan="5" className="px-6 py-12 text-center text-gray-500">
                                                        Belum ada riwayat stock opname
                                                    </td>
                                                </tr>
                                            ) : (
                                                stocktakes.map(st => {
                                                    const totalDiff = st.items.reduce((sum, item) => sum + (item.difference || 0), 0);
                                                    
                                                    return (
                                                        <tr key={st.id} className="hover:bg-gray-50">
                                                            <td className="px-6 py-4">
                                                                <div className="text-gray-800">
                                                                    {new Date(st.date).toLocaleDateString('id-ID')}
                                                                </div>
                                                                <div className="text-sm text-gray-600">
                                                                    {new Date(st.date).toLocaleTimeString('id-ID')}
                                                                </div>
                                                            </td>
                                                            <td className="px-6 py-4">
                                                                <div className="text-gray-800">
                                                                    {st.items.length} item
                                                                </div>
                                                            </td>
                                                            <td className="px-6 py-4">
                                                                <div className={`font-bold ${totalDiff > 0 ? 'text-green-600' : totalDiff < 0 ? 'text-red-600' : 'text-gray-600'}`}>
                                                                    {totalDiff > 0 ? '+' : ''}{totalDiff}
                                                                </div>
                                                            </td>
                                                            <td className="px-6 py-4">
                                                                <div className="text-gray-800">{st.createdBy}</div>
                                                            </td>
                                                            <td className="px-6 py-4">
                                                                <div className="text-sm text-gray-600 truncate max-w-xs">
                                                                    {st.notes || '-'}
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    );
                                                })
                                            )}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        {/* Stocktake Guide */}
                        <div className="bg-blue-50 border border-blue-200 rounded-xl p-6">
                            <h3 className="text-lg font-semibold text-blue-800 mb-3">üìã Panduan Stock Opname</h3>
                            <ol className="list-decimal pl-5 space-y-2 text-blue-700">
                                <li>Klik "Stock Opname Baru" untuk memulai proses</li>
                                <li>Hitung stok fisik untuk setiap item</li>
                                <li>Masukkan jumlah fisik pada kolom "Aktual"</li>
                                <li>Sistem akan menghitung selisih otomatis</li>
                                <li>Simpan untuk update stok sistem</li>
                                <li>Cetak laporan untuk arsip</li>
                            </ol>
                        </div>
                    </div>
                );
            };

            // Barcode Management
            const renderBarcode = () => {
                return (
                    <div className="animate-fadeIn">
                        <NavigationButtons />
                        
                        <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-8">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Manajemen Barcode</h1>
                                <p className="text-gray-600">Generate dan kelola barcode untuk semua item</p>
                            </div>
                            
                            <div className="flex gap-2">
                                <button
                                    onClick={() => {
                                        // Generate barcodes for all items without barcode
                                        const itemsWithoutBarcode = items.filter(item => !item.barcode);
                                        if (itemsWithoutBarcode.length === 0) {
                                            showToast('Semua item sudah memiliki barcode', 'info');
                                            return;
                                        }
                                        
                                        const updatedItems = items.map(item => {
                                            if (!item.barcode) {
                                                return {
                                                    ...item,
                                                    barcode: generateBarcode(item.kode),
                                                    updatedAt: new Date().toISOString()
                                                };
                                            }
                                            return item;
                                        });
                                        
                                        setItems(updatedItems);
                                        saveAllData();
                                        showToast(`‚úÖ ${itemsWithoutBarcode.length} barcode berhasil digenerate`, 'success');
                                    }}
                                    className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2"
                                >
                                    <Icon.Barcode />
                                    Generate All Barcodes
                                </button>
                                <button
                                    onClick={() => exportToCSV(
                                        items.map(item => ({
                                            kode: item.kode,
                                            nama: item.nama,
                                            barcode: item.barcode,
                                            lokasi: item.lokasi
                                        })), 
                                        'barcodes'
                                    )}
                                    className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2"
                                >
                                    <Icon.Download />
                                    Export Barcodes
                                </button>
                            </div>
                        </div>

                        {/* Barcode Scanner Simulation */}
                        <div className="bg-white p-6 rounded-xl shadow border mb-8">
                            <h3 className="text-lg font-semibold text-gray-800 mb-4">üì∑ Scanner Simulation</h3>
                            <div className="space-y-4">
                                <div className="flex gap-4">
                                    <input
                                        type="text"
                                        placeholder="Scan atau ketik barcode..."
                                        className="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                        onKeyPress={(e) => {
                                            if (e.key === 'Enter') {
                                                const barcode = e.target.value;
                                                const item = items.find(i => i.barcode === barcode || i.kode === barcode);
                                                if (item) {
                                                    alert(`Item ditemukan:\n\nKode: ${item.kode}\nNama: ${item.nama}\nStok: ${item.jumlah} ${item.satuan}\nLokasi: ${item.lokasi}`);
                                                    e.target.value = '';
                                                } else {
                                                    showToast('Barcode tidak ditemukan', 'error');
                                                }
                                            }
                                        }}
                                    />
                                    <button 
                                        onClick={() => {
                                            // Simulate scan button
                                            const input = document.querySelector('input[placeholder="Scan atau ketik barcode..."]');
                                            if (input) {
                                                const barcode = input.value;
                                                if (barcode) {
                                                    const item = items.find(i => i.barcode === barcode || i.kode === barcode);
                                                    if (item) {
                                                        alert(`Item ditemukan:\n\nKode: ${item.kode}\nNama: ${item.nama}\nStok: ${item.jumlah} ${item.satuan}\nLokasi: ${item.lokasi}`);
                                                        input.value = '';
                                                    } else {
                                                        showToast('Barcode tidak ditemukan', 'error');
                                                    }
                                                } else {
                                                    showToast('Masukkan barcode terlebih dahulu', 'warning');
                                                }
                                            }
                                        }}
                                        className="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                                    >
                                        Scan
                                    </button>
                                </div>
                                <p className="text-sm text-gray-600">
                                    Tekan Enter setelah mengetik barcode untuk mencari item
                                </p>
                            </div>
                        </div>

                        {/* Barcode Preview */}
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {items.slice(0, 6).map(item => (
                                <div key={item.id} className="bg-white p-6 rounded-xl shadow border hover:shadow-md transition">
                                    <div className="mb-4">
                                        <h4 className="font-semibold text-gray-800">{item.nama}</h4>
                                        <p className="text-sm text-gray-600">{item.kode} ‚Ä¢ {item.lokasi}</p>
                                    </div>
                                    
                                    <BarcodeGenerator code={item.barcode} showText={false} />
                                    
                                    <div className="mt-4 flex justify-between items-center">
                                        <span className="text-sm text-gray-600">Stok: {item.jumlah} {item.satuan}</span>
                                        <button
                                            onClick={() => {
                                                // Print barcode
                                                const printContent = `
                                                    <html>
                                                    <head>
                                                        <title>Barcode ${item.kode}</title>
                                                        <style>
                                                            @import url('https://fonts.googleapis.com/css2?family=Libre+Barcode+128&display=swap');
                                                            body { 
                                                                font-family: 'Libre Barcode 128', monospace; 
                                                                text-align: center; 
                                                                padding: 20px;
                                                                font-size: 48px;
                                                            }
                                                            .code { 
                                                                font-family: monospace; 
                                                                font-size: 14px; 
                                                                margin-top: 10px;
                                                            }
                                                            .name {
                                                                font-family: sans-serif;
                                                                font-size: 16px;
                                                                margin-bottom: 10px;
                                                            }
                                                        </style>
                                                    </head>
                                                    <body>
                                                        <div class="name">${item.nama}</div>
                                                        <div>${item.barcode}</div>
                                                        <div class="code">${item.kode}</div>
                                                        <div style="font-family: sans-serif; font-size: 12px; margin-top: 10px;">${new Date().toLocaleDateString('id-ID')}</div>
                                                    </body>
                                                    </html>
                                                `;
                                                
                                                const printWindow = window.open('', '_blank');
                                                printWindow.document.write(printContent);
                                                printWindow.document.close();
                                                printWindow.print();
                                            }}
                                            className="px-3 py-1 bg-blue-50 text-blue-700 rounded text-sm hover:bg-blue-100"
                                        >
                                            Print
                                        </button>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            };

            // Locations Management
            const renderLocations = () => {
                return (
                    <div className="animate-fadeIn">
                        <NavigationButtons />
                        
                        <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-8">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Manajemen Lokasi</h1>
                                <p className="text-gray-600">Kelola lokasi penyimpanan dan kapasitas</p>
                            </div>
                            
                            <div className="flex gap-2">
                                <button
                                    onClick={() => {
                                        resetForm('location');
                                        setShowLocationForm(true);
                                    }}
                                    className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2"
                                >
                                    <Icon.Add />
                                    Tambah Lokasi
                                </button>
                            </div>
                        </div>

                        {/* Warehouse Visualization */}
                        <div className="bg-white p-6 rounded-xl shadow border mb-8">
                            <h3 className="text-lg font-semibold text-gray-800 mb-4">üè¢ Denah Kantor & Gudang</h3>
                            <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                                {locations.map(location => {
                                    const itemsInLocation = items.filter(item => item.lokasi === location.name).length;
                                    const usagePercentage = location.capacity > 0 ? (itemsInLocation / location.capacity * 100) : 0;
                                    const isFull = usagePercentage >= 90;
                                    const isWarning = usagePercentage >= 70;
                                    
                                    return (
                                        <div 
                                            key={location.id} 
                                            className={`p-4 rounded-lg border-2 text-center ${isFull ? 'bg-red-50 border-red-300' : isWarning ? 'bg-yellow-50 border-yellow-300' : 'bg-green-50 border-green-300'}`}
                                        >
                                            <div className="font-semibold text-gray-800">{location.code}</div>
                                            <div className="text-sm text-gray-600 mb-2">{location.name}</div>
                                            <div className="text-xs">
                                                <div className="font-medium">{itemsInLocation} / {location.capacity || '‚àû'}</div>
                                                <div className={`text-xs ${isFull ? 'text-red-600' : isWarning ? 'text-yellow-600' : 'text-green-600'}`}>
                                                    {location.capacity > 0 ? `${usagePercentage.toFixed(0)}% terisi` : 'Unlimited'}
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>

                        {/* Locations List */}
                        <div className="bg-white rounded-xl shadow border overflow-hidden">
                            <div className="table-container">
                                <table className="w-full min-w-full">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Kode</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Nama Lokasi</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Tipe</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Kapasitas</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Terpakai</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Status</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-200">
                                        {locations.map(location => {
                                            const itemsInLocation = items.filter(item => item.lokasi === location.name).length;
                                            const usagePercentage = location.capacity > 0 ? (itemsInLocation / location.capacity * 100) : 0;
                                            const status = usagePercentage >= 90 ? 'Penuh' : 
                                                          usagePercentage >= 70 ? 'Hampir Penuh' : 'Tersedia';
                                            const statusColor = usagePercentage >= 90 ? 'bg-red-100 text-red-800' : 
                                                               usagePercentage >= 70 ? 'bg-yellow-100 text-yellow-800' : 
                                                               'bg-green-100 text-green-800';
                                            
                                            return (
                                                <tr key={location.id} className="hover:bg-gray-50">
                                                    <td className="px-6 py-4">
                                                        <div className="font-mono font-semibold text-blue-600">
                                                            {location.code}
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <div className="font-medium text-gray-800">{location.name}</div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <span className="px-2 py-1 bg-gray-100 text-gray-800 rounded text-xs">
                                                            {location.type}
                                                        </span>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <div className="text-gray-800">{location.capacity || '‚àû'}</div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <div>
                                                            <div className="font-medium text-gray-800">{itemsInLocation} item</div>
                                                            {location.capacity > 0 && (
                                                                <div className="w-full bg-gray-200 rounded-full h-1.5 mt-1">
                                                                    <div 
                                                                        className={`h-1.5 rounded-full ${usagePercentage >= 90 ? 'bg-red-500' : usagePercentage >= 70 ? 'bg-yellow-500' : 'bg-green-500'}`}
                                                                        style={{ width: `${Math.min(usagePercentage, 100)}%` }}
                                                                    ></div>
                                                                </div>
                                                            )}
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <span className={`px-2 py-1 rounded text-xs ${statusColor}`}>
                                                            {status}
                                                        </span>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <button
                                                            onClick={() => {
                                                                const locationItems = items.filter(item => item.lokasi === location.name);
                                                                if (locationItems.length === 0) {
                                                                    showToast('Tidak ada item di lokasi ini', 'info');
                                                                } else {
                                                                    exportToCSV(locationItems, `items-${location.code}`);
                                                                }
                                                            }}
                                                            className="px-3 py-1 bg-blue-50 text-blue-700 rounded text-sm hover:bg-blue-100"
                                                        >
                                                            Export Items
                                                        </button>
                                                    </td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            };

            // Users Management
            const renderUsers = () => {
                if (!checkPermission('manage_users') && user?.role !== 'owner') {
                    return (
                        <div className="text-center py-12">
                            <p className="text-gray-500">Anda tidak memiliki akses ke halaman ini.</p>
                        </div>
                    );
                }

                return (
                    <div className="animate-fadeIn">
                        <NavigationButtons />
                        
                        <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-8">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Manajemen Users</h1>
                                <p className="text-gray-600">Kelola user dan permissions sistem</p>
                            </div>
                            
                            <div className="flex gap-2">
                                <button
                                    onClick={() => {
                                        resetForm('user');
                                        setShowUserForm(true);
                                    }}
                                    className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2"
                                >
                                    <Icon.Add />
                                    Tambah User
                                </button>
                            </div>
                        </div>

                        {/* Users Table */}
                        <div className="bg-white rounded-xl shadow border overflow-hidden">
                            <div className="table-container">
                                <table className="w-full min-w-full">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Username</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Role</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Permissions</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Dibuat</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Oleh</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-200">
                                        {users.length === 0 ? (
                                            <tr>
                                                <td colSpan="6" className="px-6 py-12 text-center text-gray-500">
                                                    Belum ada user tambahan
                                                </td>
                                            </tr>
                                        ) : (
                                            users.map(u => (
                                                <tr key={u.id} className="hover:bg-gray-50">
                                                    <td className="px-6 py-4">
                                                        <div className="font-medium text-gray-800">{u.username}</div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <span className="px-2 py-1 bg-gray-100 text-gray-800 rounded text-xs">
                                                            {u.role}
                                                        </span>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <div className="flex flex-wrap gap-1">
                                                            {u.permissions?.map(perm => (
                                                                <span key={perm} className="px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs">
                                                                    {perm}
                                                                </span>
                                                            ))}
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <div className="text-sm text-gray-600">
                                                            {new Date(u.createdAt).toLocaleDateString('id-ID')}
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <div className="text-sm text-gray-600">{u.createdBy}</div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <span className="px-2 py-1 bg-green-100 text-green-800 rounded text-xs">
                                                            Active
                                                        </span>
                                                    </td>
                                                </tr>
                                            ))
                                        )}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            };

            // History
            const renderHistory = () => {
                return (
                    <div className="animate-fadeIn">
                        <NavigationButtons />
                        
                        <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-8">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Audit Trail & Riwayat</h1>
                                <p className="text-gray-600">Catatan lengkap semua aktivitas sistem</p>
                            </div>
                            
                            <div className="flex gap-2">
                                <button
                                    onClick={() => exportToCSV(history, 'audit-trail')}
                                    className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2"
                                >
                                    <Icon.Download />
                                    Export Log
                                </button>
                            </div>
                        </div>

                        {/* Audit Trail */}
                        <div className="bg-white rounded-xl shadow border overflow-hidden">
                            <div className="table-container max-h-[600px] overflow-y-auto">
                                <table className="w-full min-w-full">
                                    <thead className="bg-gray-50 sticky top-0">
                                        <tr>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Timestamp</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Aksi</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Data</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">User</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">Role</th>
                                            <th className="px-6 py-4 text-left text-sm font-semibold text-gray-700">IP</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-200">
                                        {history.length === 0 ? (
                                            <tr>
                                                <td colSpan="6" className="px-6 py-12 text-center text-gray-500">
                                                    Belum ada riwayat aktivitas
                                                </td>
                                            </tr>
                                        ) : (
                                            history.map(record => (
                                                <tr key={record.id} className="hover:bg-gray-50">
                                                    <td className="px-6 py-4">
                                                        <div className="text-sm text-gray-800">
                                                            {new Date(record.timestamp).toLocaleDateString('id-ID')}
                                                        </div>
                                                        <div className="text-xs text-gray-500">
                                                            {new Date(record.timestamp).toLocaleTimeString('id-ID')}
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <span className={`px-2 py-1 rounded text-xs ${
                                                            record.action.includes('CREATE') ? 'bg-green-100 text-green-800' :
                                                            record.action.includes('UPDATE') ? 'bg-blue-100 text-blue-800' :
                                                            record.action.includes('DELETE') ? 'bg-red-100 text-red-800' :
                                                            'bg-gray-100 text-gray-800'
                                                        }`}>
                                                            {record.action.replace('_', ' ')}
                                                        </span>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <div className="text-sm text-gray-600 truncate max-w-xs">
                                                            {JSON.stringify(record.data).substring(0, 100)}...
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <div className="font-medium">{record.user}</div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <span className="px-2 py-1 bg-gray-100 text-gray-800 rounded text-xs">
                                                            {record.role}
                                                        </span>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <div className="text-xs text-gray-500 font-mono">{record.ip}</div>
                                                    </td>
                                                </tr>
                                            ))
                                        )}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            };

            // Reports
            const renderReports = () => {
                // Generate report data
                const categoryReport = Object.entries(
                    items.reduce((acc, item) => {
                        acc[item.kategori] = (acc[item.kategori] || 0) + 1;
                        return acc;
                    }, {})
                ).map(([category, count]) => ({
                    category,
                    count,
                    percentage: items.length > 0 ? ((count / items.length) * 100).toFixed(1) : '0'
                })).sort((a, b) => b.count - a.count);

                const locationReport = Object.entries(
                    items.reduce((acc, item) => {
                        acc[item.lokasi] = (acc[item.lokasi] || 0) + 1;
                        return acc;
                    }, {})
                ).map(([location, count]) => ({
                    location,
                    count
                })).sort((a, b) => b.count - a.count);

                const valueReport = items
                    .map(item => ({
                        name: item.nama,
                        value: item.jumlah * item.harga,
                        stock: item.jumlah
                    }))
                    .sort((a, b) => b.value - a.value)
                    .slice(0, 10);

                return (
                    <div className="animate-fadeIn">
                        <NavigationButtons />
                        
                        <div className="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-8">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-800 mb-2">Laporan & Analytics</h1>
                                <p className="text-gray-600">Analisis data dan laporan lengkap</p>
                            </div>
                            
                            <div className="flex flex-wrap gap-2">
                                <button
                                    onClick={() => exportToCSV(items, 'full-inventory-report')}
                                    className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2"
                                >
                                    <Icon.Download />
                                    Full Report
                                </button>
                                <button
                                    onClick={() => {
                                        // Generate comprehensive report
                                        const reportData = {
                                            summary: statistics,
                                            topItems: valueReport,
                                            categoryDistribution: categoryReport,
                                            locationDistribution: locationReport,
                                            generatedAt: new Date().toISOString(),
                                            generatedBy: user?.username
                                        };
                                        
                                        const blob = new Blob([JSON.stringify(reportData, null, 2)], { type: 'application/json' });
                                        const url = URL.createObjectURL(blob);
                                        const a = document.createElement('a');
                                        a.href = url;
                                        a.download = `analytics-report-${new Date().toISOString().split('T')[0]}.json`;
                                        a.click();
                                        
                                        showToast('‚úÖ Laporan analytics berhasil di-generate', 'success');
                                    }}
                                    className="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center gap-2"
                                >
                                    <Icon.Chart />
                                    Analytics JSON
                                </button>
                                <button
                                    onClick={() => {
                                        // Print summary report
                                        const printContent = `
                                            <html>
                                            <head>
                                                <title>Laporan Inventori</title>
                                                <style>
                                                    body { font-family: Arial, sans-serif; padding: 20px; }
                                                    h1 { color: #4f46e5; text-align: center; }
                                                    .summary { background: #f9fafb; padding: 20px; border-radius: 10px; margin: 20px 0; }
                                                    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                                                    th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
                                                    th { background: #4f46e5; color: white; }
                                                    .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 20px 0; }
                                                    .stat-card { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
                                                </style>
                                            </head>
                                            <body>
                                                <h1>üìä LAPORAN INVENTORI ASET RAS</h1>
                                                <p><strong>Tanggal:</strong> ${new Date().toLocaleString('id-ID')}</p>
                                                <p><strong>Dibuat oleh:</strong> ${user?.username} (${user?.role})</p>
                                                
                                                <div class="summary">
                                                    <h2>Ringkasan Statistik</h2>
                                                    <div class="stats">
                                                        <div class="stat-card">
                                                            <h3>Total Barang</h3>
                                                            <p style="font-size: 24px; font-weight: bold;">${statistics.totalItems}</p>
                                                        </div>
                                                        <div class="stat-card">
                                                            <h3>Total Nilai</h3>
                                                            <p style="font-size: 24px; font-weight: bold; color: #10b981;">Rp ${statistics.totalValue.toLocaleString('id-ID')}</p>
                                                        </div>
                                                        <div class="stat-card">
                                                            <h3>Stok Rendah</h3>
                                                            <p style="font-size: 24px; font-weight: bold; color: #ef4444;">${statistics.lowStockItems}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <h2>Distribusi Kategori</h2>
                                                <table>
                                                    <thead>
                                                        <tr>
                                                            <th>Kategori</th>
                                                            <th>Jumlah Item</th>
                                                            <th>Persentase</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        ${categoryReport.map(cat => `
                                                            <tr>
                                                                <td>${cat.category}</td>
                                                                <td>${cat.count}</td>
                                                                <td>${cat.percentage}%</td>
                                                            </tr>
                                                        `).join('')}
                                                    </tbody>
                                                </table>
                                                
                                                <h2>10 Barang dengan Nilai Tertinggi</h2>
                                                <table>
                                                    <thead>
                                                        <tr>
                                                            <th>Nama Barang</th>
                                                            <th>Nilai Total</th>
                                                            <th>Stok</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        ${valueReport.map(item => `
                                                            <tr>
                                                                <td>${item.name}</td>
                                                                <td>Rp ${item.value.toLocaleString('id-ID')}</td>
                                                                <td>${item.stock}</td>
                                                            </tr>
                                                        `).join('')}
                                                    </tbody>
                                                </table>
                                                
                                                <div style="margin-top: 40px; text-align: center; color: #6b7280; font-size: 12px;">
                                                    <p>Sistem Inventori Aset RAS ‚Ä¢ Laporan di-generate otomatis</p>
                                                </div>
                                            </body>
                                            </html>
                                        `;
                                        
                                        const printWindow = window.open('', '_blank');
                                        printWindow.document.write(printContent);
                                        printWindow.document.close();
                                        printWindow.print();
                                    }}
                                    className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2"
                                >
                                    <Icon.Print />
                                    Print Summary
                                </button>
                            </div>
                        </div>

                        {/* Report Grid */}
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                            {/* Category Distribution */}
                            <div className="bg-white p-6 rounded-xl shadow border">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4">Distribusi Kategori</h3>
                                <div className="space-y-4">
                                    {categoryReport.map((cat, index) => (
                                        <div key={index} className="space-y-2">
                                            <div className="flex justify-between text-sm">
                                                <span className="text-gray-700">{cat.category}</span>
                                                <span className="font-semibold">{cat.count} ({cat.percentage}%)</span>
                                            </div>
                                            <div className="w-full bg-gray-200 rounded-full h-2">
                                                <div 
                                                    className="bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full"
                                                    style={{ width: `${cat.percentage}%` }}
                                                ></div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {/* Top Valuable Items */}
                            <div className="bg-white p-6 rounded-xl shadow border">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4">10 Barang dengan Nilai Tertinggi</h3>
                                <div className="space-y-3">
                                    {valueReport.map((item, index) => (
                                        <div key={index} className="flex items-center justify-between p-3 bg-gray-50 rounded">
                                            <div className="flex-1">
                                                <p className="font-medium text-gray-800">{item.name}</p>
                                                <p className="text-sm text-gray-600">Stok: {item.stock}</p>
                                            </div>
                                            <div className="text-right">
                                                <p className="font-bold text-green-600">Rp {item.value.toLocaleString('id-ID')}</p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* Location Distribution */}
                        <div className="bg-white p-6 rounded-xl shadow border">
                            <h3 className="text-lg font-semibold text-gray-800 mb-4">Distribusi Lokasi</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                {locationReport.map((loc, index) => (
                                    <div key={index} className="p-4 bg-gray-50 rounded">
                                        <div className="flex items-center justify-between mb-2">
                                            <span className="font-medium text-gray-800">{loc.location}</span>
                                            <span className="text-blue-600 font-bold">{loc.count}</span>
                                        </div>
                                        <div className="text-sm text-gray-600">
                                            {items.length > 0 ? ((loc.count / items.length) * 100).toFixed(1) : 0}% dari total
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            };

            // Settings
            const renderSettings = () => {
                return (
                    <div className="animate-fadeIn">
                        <NavigationButtons />
                        
                        <div className="mb-8">
                            <h1 className="text-3xl font-bold text-gray-800 mb-2">Pengaturan Sistem</h1>
                            <p className="text-gray-600">Konfigurasi dan pengaturan sistem</p>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            {/* User Profile */}
                            <div className="bg-white p-6 rounded-xl shadow border">
                                <h3 className="text-lg font-semibold text-gray-800 mb-6">Profil Pengguna</h3>
                                <div className="space-y-6">
                                    <div className="flex items-center gap-4">
                                        <div className="w-16 h-16 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center text-white text-2xl font-bold">
                                            {user?.username?.charAt(0).toUpperCase()}
                                        </div>
                                        <div>
                                            <h4 className="text-xl font-bold text-gray-800">{user?.username}</h4>
                                            <p className="text-gray-600 capitalize">{user?.role}</p>
                                            <p className="text-sm text-gray-500">Terdaftar sejak: {new Date().toLocaleDateString('id-ID')}</p>
                                        </div>
                                    </div>

                                    <div className="space-y-3">
                                        <div className="p-4 bg-gray-50 rounded">
                                            <p className="text-sm text-gray-600 mb-1">Hak Akses</p>
                                            <div className="flex flex-wrap gap-1">
                                                {user?.permissions?.map(perm => (
                                                    <span key={perm} className="px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs">
                                                        {perm}
                                                    </span>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* System Settings */}
                            <div className="bg-white p-6 rounded-xl shadow border">
                                <h3 className="text-lg font-semibold text-gray-800 mb-6">Pengaturan Sistem</h3>
                                <div className="space-y-6">
                                    <div>
                                        <h4 className="font-semibold text-gray-800 mb-3">Backup & Restore</h4>
                                        <div className="space-y-3">
                                            <button
                                                onClick={createBackup}
                                                className="w-full p-3 bg-blue-50 text-blue-700 rounded hover:bg-blue-100 flex items-center gap-3"
                                            >
                                                <Icon.Backup />
                                                <div className="text-left">
                                                    <div className="font-semibold">Buat Backup</div>
                                                    <div className="text-sm">Backup semua data ke file JSON</div>
                                                </div>
                                            </button>

                                            <label className="w-full p-3 bg-green-50 text-green-700 rounded hover:bg-green-100 flex items-center gap-3 cursor-pointer">
                                                <Icon.Restore />
                                                <div className="text-left">
                                                    <div className="font-semibold">Restore Data</div>
                                                    <div className="text-sm">Restore dari file backup</div>
                                                </div>
                                                <input
                                                    type="file"
                                                    accept=".json"
                                                    onChange={restoreBackup}
                                                    className="hidden"
                                                />
                                            </label>
                                        </div>
                                    </div>

                                    <div>
                                        <h4 className="font-semibold text-gray-800 mb-3">Data Management</h4>
                                        <div className="space-y-2">
                                            <button
                                                onClick={() => {
                                                    if (window.confirm('Export semua data ke CSV?')) {
                                                        exportToCSV(items, 'all-inventory-data');
                                                    }
                                                }}
                                                className="w-full text-left p-3 bg-gray-50 text-gray-700 rounded hover:bg-gray-100"
                                            >
                                                Export Semua Data (CSV)
                                            </button>
                                            
                                            {checkPermission('backup_restore') && (
                                                <button
                                                    onClick={() => {
                                                        if (window.confirm('‚ö†Ô∏è HAPUS SEMUA DATA?\n\nTindakan ini tidak dapat dibatalkan!\n\nYakin ingin menghapus semua data?')) {
                                                            // Clear all data
                                                            setItems([]);
                                                            setSuppliers([]);
                                                            setPurchaseOrders([]);
                                                            setStocktakes([]);
                                                            setUsers([]);
                                                            setLocations([]);
                                                            setHistory([]);
                                                            
                                                            saveAllData();
                                                            showToast('Semua data telah dihapus', 'warning');
                                                        }
                                                    }}
                                                    className="w-full text-left p-3 bg-red-50 text-red-700 rounded hover:bg-red-100"
                                                >
                                                    Hapus Semua Data
                                                </button>
                                            )}
                                        </div>
                                    </div>

                                    <div className="pt-6 border-t">
                                        <button
                                            onClick={handleLogout}
                                            className="w-full p-4 bg-gray-800 text-white rounded hover:bg-gray-900 flex items-center justify-center gap-3"
                                        >
                                            <Icon.Logout />
                                            <span className="font-semibold">Logout dari Sistem</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            // ==================== FORM MODALS ====================
            
            // Item Form Modal
            const renderItemForm = () => (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                        <div className="p-6 border-b">
                            <div className="flex items-center justify-between">
                                <h3 className="text-xl font-bold text-gray-800">
                                    {formData.id ? 'Edit Barang' : 'Tambah Barang Baru'}
                                </h3>
                                <button
                                    onClick={() => {
                                        resetForm('item');
                                        setShowItemForm(false);
                                    }}
                                    className="text-gray-400 hover:text-gray-600"
                                >
                                    ‚úï
                                </button>
                            </div>
                        </div>
                        
                        <div className="p-6">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                {/* Basic Information */}
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Kode Barang
                                        </label>
                                        <input
                                            type="text"
                                            value={formData.kode}
                                            readOnly
                                            className="w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Nama Barang *
                                        </label>
                                        <input
                                            type="text"
                                            value={formData.nama}
                                            onChange={(e) => setFormData({...formData, nama: e.target.value})}
                                            className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500"
                                            placeholder="Contoh: Laptop Asus ROG"
                                            required
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Kategori *
                                        </label>
                                        <select
                                            value={formData.kategori}
                                            onChange={(e) => setFormData({...formData, kategori: e.target.value})}
                                            className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500"
                                            required
                                        >
                                            <option value="">Pilih Kategori</option>
                                            {categories.map(cat => (
                                                <option key={cat} value={cat}>{cat}</option>
                                            ))}
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Lokasi Penyimpanan
                                        </label>
                                        <select
                                            value={formData.lokasi}
                                            onChange={(e) => setFormData({...formData, lokasi: e.target.value})}
                                            className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500"
                                        >
                                            <option value="">Pilih Lokasi</option>
                                            {locations.map(loc => (
                                                <option key={loc.id} value={loc.name}>{loc.name} ({loc.code})</option>
                                            ))}
                                        </select>
                                    </div>
                                </div>
                                
                                {/* Stock & Pricing */}
                                <div className="space-y-4">
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">
                                                Jumlah *
                                            </label>
                                            <input
                                                type="number"
                                                min="0"
                                                step="0.01"
                                                value={formData.jumlah}
                                                onChange={(e) => setFormData({...formData, jumlah: e.target.value})}
                                                className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500"
                                                placeholder="0"
                                                required
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">
                                                Satuan *
                                            </label>
                                            <select
                                                value={formData.satuan}
                                                onChange={(e) => setFormData({...formData, satuan: e.target.value})}
                                                className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500"
                                                required
                                            >
                                                <option value="">Pilih Satuan</option>
                                                {units.map(unit => (
                                                    <option key={unit} value={unit}>{unit}</option>
                                                ))}
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Harga Satuan (Rp) *
                                        </label>
                                        <input
                                            type="number"
                                            min="0"
                                            step="0.01"
                                            value={formData.harga}
                                            onChange={(e) => setFormData({...formData, harga: e.target.value})}
                                            className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500"
                                            placeholder="0"
                                            required
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Stok Minimal (Peringatan)
                                        </label>
                                        <input
                                            type="number"
                                            min="0"
                                            value={formData.stokMinimal}
                                            onChange={(e) => setFormData({...formData, stokMinimal: e.target.value})}
                                            className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500"
                                            placeholder="0"
                                        />
                                        <p className="text-sm text-gray-500 mt-1">
                                            Sistem akan memberikan peringatan jika stok mencapai atau di bawah angka ini
                                        </p>
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Barcode
                                        </label>
                                        <input
                                            type="text"
                                            value={formData.barcode}
                                            onChange={(e) => setFormData({...formData, barcode: e.target.value})}
                                            className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500"
                                            placeholder="Auto-generate jika kosong"
                                        />
                                        {formData.barcode && (
                                            <div className="mt-2">
                                                <BarcodeGenerator code={formData.barcode} showText={false} />
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                            
                            <div className="flex gap-3 pt-6 border-t">
                                <button
                                    onClick={saveItem}
                                    className="flex-1 bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700"
                                >
                                    {formData.id ? 'Update Barang' : 'Simpan Barang'}
                                </button>
                                <button
                                    onClick={() => {
                                        resetForm('item');
                                        setShowItemForm(false);
                                    }}
                                    className="px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50"
                                >
                                    Batal
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // Supplier Form Modal
            const renderSupplierForm = () => (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-xl w-full max-w-md">
                        <div className="p-6 border-b">
                            <div className="flex items-center justify-between">
                                <h3 className="text-xl font-bold text-gray-800">Tambah Supplier</h3>
                                <button
                                    onClick={() => {
                                        resetForm('supplier');
                                        setShowSupplierForm(false);
                                    }}
                                    className="text-gray-400 hover:text-gray-600"
                                >
                                    ‚úï
                                </button>
                            </div>
                        </div>
                        <div className="p-6">
                            <div className="space-y-4">
                                <input
                                    type="text"
                                    placeholder="Nama Supplier *"
                                    value={formData.supplierName}
                                    onChange={(e) => setFormData({...formData, supplierName: e.target.value})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded"
                                    required
                                />
                                <input
                                    type="text"
                                    placeholder="Nama Kontak *"
                                    value={formData.supplierContact}
                                    onChange={(e) => setFormData({...formData, supplierContact: e.target.value})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded"
                                    required
                                />
                                <input
                                    type="text"
                                    placeholder="Alamat"
                                    value={formData.supplierAddress}
                                    onChange={(e) => setFormData({...formData, supplierAddress: e.target.value})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded"
                                />
                                <input
                                    type="tel"
                                    placeholder="Telepon"
                                    value={formData.supplierPhone}
                                    onChange={(e) => setFormData({...formData, supplierPhone: e.target.value})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded"
                                />
                                <input
                                    type="email"
                                    placeholder="Email"
                                    value={formData.supplierEmail}
                                    onChange={(e) => setFormData({...formData, supplierEmail: e.target.value})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded"
                                />
                            </div>
                            <div className="flex gap-3 mt-6">
                                <button
                                    onClick={saveSupplier}
                                    className="flex-1 bg-blue-600 text-white py-2 rounded"
                                >
                                    Simpan
                                </button>
                                <button
                                    onClick={() => {
                                        resetForm('supplier');
                                        setShowSupplierForm(false);
                                    }}
                                    className="px-6 py-2 border border-gray-300 rounded hover:bg-gray-50"
                                >
                                    Batal
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // Purchase Order Form Modal
            const renderPOForm = () => (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                        <div className="p-6 border-b">
                            <div className="flex items-center justify-between">
                                <h3 className="text-xl font-bold text-gray-800">Buat Purchase Order Baru</h3>
                                <button
                                    onClick={() => {
                                        resetForm('purchase');
                                        setShowPOForm(false);
                                    }}
                                    className="text-gray-400 hover:text-gray-600"
                                >
                                    ‚úï
                                </button>
                            </div>
                        </div>
                        <div className="p-6">
                            <div className="space-y-4 mb-6">
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Nomor PO
                                        </label>
                                        <input
                                            type="text"
                                            value={formData.poNumber}
                                            readOnly
                                            className="w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Tanggal
                                        </label>
                                        <input
                                            type="date"
                                            value={formData.poDate}
                                            onChange={(e) => setFormData({...formData, poDate: e.target.value})}
                                            className="w-full px-4 py-3 border border-gray-300 rounded"
                                        />
                                    </div>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Pilih Supplier *
                                    </label>
                                    <select
                                        value={formData.poSupplierId}
                                        onChange={(e) => setFormData({...formData, poSupplierId: e.target.value})}
                                        className="w-full px-4 py-3 border border-gray-300 rounded"
                                        required
                                    >
                                        <option value="">Pilih Supplier</option>
                                        {suppliers.map(sup => (
                                            <option key={sup.id} value={sup.id}>{sup.name} ({sup.code})</option>
                                        ))}
                                    </select>
                                </div>
                            </div>
                            
                            <div className="mb-6">
                                <h4 className="font-semibold text-gray-800 mb-3">Tambah Item</h4>
                                <div className="space-y-3">
                                    <div className="flex gap-2">
                                        <select
                                            className="flex-1 px-3 py-2 border border-gray-300 rounded"
                                            onChange={(e) => {
                                                const itemId = e.target.value;
                                                if (itemId) {
                                                    const item = items.find(i => i.id === parseInt(itemId));
                                                    if (item) {
                                                        const newItem = {
                                                            itemId: item.id,
                                                            itemName: item.nama,
                                                            itemCode: item.kode,
                                                            quantity: 1,
                                                            price: item.harga
                                                        };
                                                        setFormData({
                                                            ...formData,
                                                            poItems: [...formData.poItems, newItem]
                                                        });
                                                        e.target.value = '';
                                                    }
                                                }
                                            }}
                                        >
                                            <option value="">Pilih Item</option>
                                            {items.map(item => (
                                                <option key={item.id} value={item.id}>
                                                    {item.nama} ({item.kode}) - Rp {item.harga.toLocaleString('id-ID')}
                                                </option>
                                            ))}
                                        </select>
                                        <button
                                            onClick={() => {
                                                // Manual add item
                                                const itemName = prompt('Masukkan nama item:');
                                                if (itemName) {
                                                    const newItem = {
                                                        itemId: Date.now(),
                                                        itemName,
                                                        itemCode: 'MANUAL-' + Date.now(),
                                                        quantity: parseInt(prompt('Jumlah:', '1')) || 1,
                                                        price: parseFloat(prompt('Harga:', '0')) || 0
                                                    };
                                                    setFormData({
                                                        ...formData,
                                                        poItems: [...formData.poItems, newItem]
                                                    });
                                                }
                                            }}
                                            className="px-4 py-2 bg-blue-50 text-blue-700 rounded hover:bg-blue-100"
                                        >
                                            Tambah Manual
                                        </button>
                                    </div>
                                    
                                    {formData.poItems.length > 0 && (
                                        <div className="bg-gray-50 rounded p-4">
                                            <h5 className="font-semibold text-gray-800 mb-2">Items dalam PO</h5>
                                            <div className="space-y-2">
                                                {formData.poItems.map((item, index) => (
                                                    <div key={index} className="flex items-center justify-between bg-white p-3 rounded">
                                                        <div>
                                                            <p className="font-medium">{item.itemName}</p>
                                                            <p className="text-sm text-gray-600">{item.itemCode}</p>
                                                        </div>
                                                        <div className="flex items-center gap-4">
                                                            <div className="text-right">
                                                                <p>{item.quantity} x Rp {item.price.toLocaleString('id-ID')}</p>
                                                                <p className="font-semibold">Rp {(item.quantity * item.price).toLocaleString('id-ID')}</p>
                                                            </div>
                                                            <button
                                                                onClick={() => {
                                                                    const newItems = formData.poItems.filter((_, i) => i !== index);
                                                                    setFormData({...formData, poItems: newItems});
                                                                }}
                                                                className="text-red-500 hover:text-red-700"
                                                            >
                                                                ‚úï
                                                            </button>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                            <div className="mt-3 pt-3 border-t">
                                                <p className="font-bold text-lg text-green-600">
                                                    Total: Rp {formData.poItems.reduce((sum, item) => sum + (item.quantity * item.price), 0).toLocaleString('id-ID')}
                                                </p>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                            
                            <div className="flex gap-3 pt-6 border-t">
                                <button
                                    onClick={savePurchaseOrder}
                                    className="flex-1 bg-blue-600 text-white py-3 rounded font-semibold hover:bg-blue-700"
                                >
                                    Buat Purchase Order
                                </button>
                                <button
                                    onClick={() => {
                                        resetForm('purchase');
                                        setShowPOForm(false);
                                    }}
                                    className="px-6 py-3 border border-gray-300 rounded hover:bg-gray-50"
                                >
                                    Batal
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // Stocktake Form Modal
            const renderStocktakeForm = () => (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                        <div className="p-6 border-b">
                            <div className="flex items-center justify-between">
                                <h3 className="text-xl font-bold text-gray-800">Stock Opname Baru</h3>
                                <button
                                    onClick={() => {
                                        resetForm('stocktake');
                                        setShowStocktakeForm(false);
                                    }}
                                    className="text-gray-400 hover:text-gray-600"
                                >
                                    ‚úï
                                </button>
                            </div>
                        </div>
                        <div className="p-6">
                            <div className="space-y-4 mb-6">
                                <div className="grid grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Tanggal Stock Opname
                                        </label>
                                        <input
                                            type="date"
                                            value={formData.stDate}
                                            onChange={(e) => setFormData({...formData, stDate: e.target.value})}
                                            className="w-full px-4 py-3 border border-gray-300 rounded"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            Catatan (Opsional)
                                        </label>
                                        <input
                                            type="text"
                                            value={formData.stNotes}
                                            onChange={(e) => setFormData({...formData, stNotes: e.target.value})}
                                            className="w-full px-4 py-3 border border-gray-300 rounded"
                                            placeholder="Misal: Stock opname akhir bulan"
                                        />
                                    </div>
                                </div>
                            </div>
                            
                            <div className="mb-6">
                                <h4 className="font-semibold text-gray-800 mb-3">Items untuk Stock Opname</h4>
                                <div className="space-y-3">
                                    <div className="flex gap-2 mb-4">
                                        <button
                                            onClick={() => {
                                                // Add random 10 items
                                                const randomItems = items
                                                    .sort(() => Math.random() - 0.5)
                                                    .slice(0, 10)
                                                    .map(item => ({
                                                        itemId: item.id,
                                                        itemName: item.nama,
                                                        itemCode: item.kode,
                                                        systemQty: item.jumlah,
                                                        actual: item.jumlah,
                                                        difference: 0,
                                                        notes: ''
                                                    }));
                                                setFormData({
                                                    ...formData,
                                                    stItems: [...formData.stItems, ...randomItems]
                                                });
                                            }}
                                            className="px-4 py-2 bg-blue-50 text-blue-700 rounded hover:bg-blue-100"
                                        >
                                            Tambah 10 Item Acak
                                        </button>
                                        <button
                                            onClick={() => {
                                                // Add all low stock items
                                                const lowStock = items
                                                    .filter(item => item.stokMinimal && item.jumlah <= item.stokMinimal)
                                                    .map(item => ({
                                                        itemId: item.id,
                                                        itemName: item.nama,
                                                        itemCode: item.kode,
                                                        systemQty: item.jumlah,
                                                        actual: item.jumlah,
                                                        difference: 0,
                                                        notes: 'Stok rendah'
                                                    }));
                                                setFormData({
                                                    ...formData,
                                                    stItems: [...formData.stItems, ...lowStock]
                                                });
                                            }}
                                            className="px-4 py-2 bg-red-50 text-red-700 rounded hover:bg-red-100"
                                        >
                                            Tambah Stok Rendah
                                        </button>
                                    </div>
                                    
                                    {formData.stItems.length > 0 ? (
                                        <div className="bg-gray-50 rounded p-4">
                                            <div className="overflow-x-auto">
                                                <table className="w-full">
                                                    <thead className="bg-gray-100">
                                                        <tr>
                                                            <th className="px-4 py-2 text-left">Item</th>
                                                            <th className="px-4 py-2 text-left">Sistem</th>
                                                            <th className="px-4 py-2 text-left">Aktual</th>
                                                            <th className="px-4 py-2 text-left">Selisih</th>
                                                            <th className="px-4 py-2 text-left">Aksi</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {formData.stItems.map((item, index) => (
                                                            <tr key={index} className="border-b">
                                                                <td className="px-4 py-3">
                                                                    <div>
                                                                        <p className="font-medium">{item.itemName}</p>
                                                                        <p className="text-sm text-gray-600">{item.itemCode}</p>
                                                                    </div>
                                                                </td>
                                                                <td className="px-4 py-3">
                                                                    <p className="font-medium">{item.systemQty}</p>
                                                                </td>
                                                                <td className="px-4 py-3">
                                                                    <input
                                                                        type="number"
                                                                        value={item.actual}
                                                                        onChange={(e) => {
                                                                            const newActual = parseInt(e.target.value) || 0;
                                                                            const newItems = [...formData.stItems];
                                                                            newItems[index] = {
                                                                                ...newItems[index],
                                                                                actual: newActual,
                                                                                difference: newActual - newItems[index].systemQty
                                                                            };
                                                                            setFormData({...formData, stItems: newItems});
                                                                        }}
                                                                        className="w-24 px-2 py-1 border border-gray-300 rounded"
                                                                    />
                                                                </td>
                                                                <td className="px-4 py-3">
                                                                    <p className={`font-bold ${item.difference > 0 ? 'text-green-600' : item.difference < 0 ? 'text-red-600' : 'text-gray-600'}`}>
                                                                        {item.difference > 0 ? '+' : ''}{item.difference}
                                                                    </p>
                                                                </td>
                                                                <td className="px-4 py-3">
                                                                    <button
                                                                        onClick={() => {
                                                                            const newItems = formData.stItems.filter((_, i) => i !== index);
                                                                            setFormData({...formData, stItems: newItems});
                                                                        }}
                                                                        className="text-red-500 hover:text-red-700"
                                                                    >
                                                                        Hapus
                                                                    </button>
                                                                </td>
                                                            </tr>
                                                        ))}
                                                    </tbody>
                                                </table>
                                            </div>
                                            
                                            <div className="mt-4 pt-4 border-t">
                                                <div className="flex justify-between items-center">
                                                    <div>
                                                        <p className="text-sm text-gray-600">Total Items: {formData.stItems.length}</p>
                                                        <p className="text-sm text-gray-600">
                                                            Total Selisih: <span className={`font-bold ${formData.stItems.reduce((sum, item) => sum + item.difference, 0) > 0 ? 'text-green-600' : formData.stItems.reduce((sum, item) => sum + item.difference, 0) < 0 ? 'text-red-600' : 'text-gray-600'}`}>
                                                                {formData.stItems.reduce((sum, item) => sum + item.difference, 0) > 0 ? '+' : ''}
                                                                {formData.stItems.reduce((sum, item) => sum + item.difference, 0)}
                                                            </span>
                                                        </p>
                                                    </div>
                                                    <button
                                                        onClick={() => setFormData({...formData, stItems: []})}
                                                        className="px-4 py-2 bg-red-50 text-red-700 rounded hover:bg-red-100"
                                                    >
                                                        Hapus Semua
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="text-center py-8 text-gray-500">
                                            <p>Belum ada item yang ditambahkan</p>
                                            <p className="text-sm mt-2">Klik tombol di atas untuk menambahkan item</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                            
                            <div className="flex gap-3 pt-6 border-t">
                                <button
                                    onClick={saveStocktake}
                                    disabled={formData.stItems.length === 0}
                                    className={`flex-1 py-3 rounded font-semibold ${formData.stItems.length === 0 ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-blue-600 text-white hover:bg-blue-700'}`}
                                >
                                    Simpan Stock Opname
                                </button>
                                <button
                                    onClick={() => {
                                        resetForm('stocktake');
                                        setShowStocktakeForm(false);
                                    }}
                                    className="px-6 py-3 border border-gray-300 rounded hover:bg-gray-50"
                                >
                                    Batal
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // User Form Modal
            const renderUserForm = () => (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-xl w-full max-w-md">
                        <div className="p-6 border-b">
                            <div className="flex items-center justify-between">
                                <h3 className="text-xl font-bold text-gray-800">Tambah User Baru</h3>
                                <button
                                    onClick={() => {
                                        resetForm('user');
                                        setShowUserForm(false);
                                    }}
                                    className="text-gray-400 hover:text-gray-600"
                                >
                                    ‚úï
                                </button>
                            </div>
                        </div>
                        <div className="p-6">
                            <div className="space-y-4">
                                <input
                                    type="text"
                                    placeholder="Username *"
                                    value={formData.userUsername}
                                    onChange={(e) => setFormData({...formData, userUsername: e.target.value})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded"
                                    required
                                />
                                <input
                                    type="password"
                                    placeholder="Password *"
                                    value={formData.userPassword}
                                    onChange={(e) => setFormData({...formData, userPassword: e.target.value})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded"
                                    required
                                />
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Role *
                                    </label>
                                    <select
                                        value={formData.userRole}
                                        onChange={(e) => setFormData({...formData, userRole: e.target.value})}
                                        className="w-full px-4 py-3 border border-gray-300 rounded"
                                        required
                                    >
                                        {userRoles.map(role => (
                                            <option key={role.value} value={role.value}>{role.label}</option>
                                        ))}
                                    </select>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Permissions
                                    </label>
                                    <div className="space-y-2">
                                        {permissionsList.map(permission => (
                                            <label key={permission.id} className="flex items-center space-x-2">
                                                <input
                                                    type="checkbox"
                                                    checked={formData.userPermissions.includes(permission.id)}
                                                    onChange={(e) => {
                                                        if (e.target.checked) {
                                                            setFormData({
                                                                ...formData,
                                                                userPermissions: [...formData.userPermissions, permission.id]
                                                            });
                                                        } else {
                                                            setFormData({
                                                                ...formData,
                                                                userPermissions: formData.userPermissions.filter(p => p !== permission.id)
                                                            });
                                                        }
                                                    }}
                                                    className="rounded border-gray-300"
                                                />
                                                <span className="text-sm">{permission.label}</span>
                                            </label>
                                        ))}
                                    </div>
                                </div>
                            </div>
                            <div className="flex gap-3 mt-6">
                                <button
                                    onClick={saveUser}
                                    className="flex-1 bg-blue-600 text-white py-2 rounded"
                                >
                                    Simpan User
                                </button>
                                <button
                                    onClick={() => {
                                        resetForm('user');
                                        setShowUserForm(false);
                                    }}
                                    className="px-6 py-2 border border-gray-300 rounded hover:bg-gray-50"
                                >
                                    Batal
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // Location Form Modal
            const renderLocationForm = () => (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-xl w-full max-w-md">
                        <div className="p-6 border-b">
                            <div className="flex items-center justify-between">
                                <h3 className="text-xl font-bold text-gray-800">Tambah Lokasi Baru</h3>
                                <button
                                    onClick={() => {
                                        resetForm('location');
                                        setShowLocationForm(false);
                                    }}
                                    className="text-gray-400 hover:text-gray-600"
                                >
                                    ‚úï
                                </button>
                            </div>
                        </div>
                        <div className="p-6">
                            <div className="space-y-4">
                                <input
                                    type="text"
                                    placeholder="Kode Lokasi *"
                                    value={formData.locationCode}
                                    readOnly
                                    className="w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded"
                                />
                                <input
                                    type="text"
                                    placeholder="Nama Lokasi *"
                                    value={formData.locationName}
                                    onChange={(e) => setFormData({...formData, locationName: e.target.value})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded"
                                    required
                                />
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Tipe Lokasi *
                                    </label>
                                    <select
                                        value={formData.locationType}
                                        onChange={(e) => setFormData({...formData, locationType: e.target.value})}
                                        className="w-full px-4 py-3 border border-gray-300 rounded"
                                        required
                                    >
                                        {locationTypes.map(type => (
                                            <option key={type} value={type}>{type}</option>
                                        ))}
                                    </select>
                                </div>
                                <input
                                    type="number"
                                    placeholder="Kapasitas (opsional)"
                                    value={formData.locationCapacity}
                                    onChange={(e) => setFormData({...formData, locationCapacity: e.target.value})}
                                    className="w-full px-4 py-3 border border-gray-300 rounded"
                                />
                                <p className="text-sm text-gray-500">
                                    Kosongkan kapasitas untuk lokasi dengan kapasitas tak terbatas
                                </p>
                            </div>
                            <div className="flex gap-3 mt-6">
                                <button
                                    onClick={saveLocation}
                                    className="flex-1 bg-blue-600 text-white py-2 rounded"
                                >
                                    Simpan Lokasi
                                </button>
                                <button
                                    onClick={() => {
                                        resetForm('location');
                                        setShowLocationForm(false);
                                    }}
                                    className="px-6 py-2 border border-gray-300 rounded hover:bg-gray-50"
                                >
                                    Batal
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // ==================== MAIN RENDER ====================
            if (loading) {
                return <LoadingScreen />;
            }

            if (!user) {
                return <LoginPage onLogin={handleLogin} />;
            }

            // Filter tabs based on permissions
            const availableTabs = tabs.filter(tab => 
                checkPermission(tab.requiredPermission) || user.role === 'owner'
            );

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* Toast Container */}
                    <div className="toast-container">
                        {toasts.map(toast => (
                            <Toast
                                key={toast.id}
                                message={toast.message}
                                type={toast.type}
                                onClose={() => removeToast(toast.id)}
                            />
                        ))}
                    </div>

                    {/* Header */}
                    <div className="bg-white shadow border-b">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex items-center justify-between h-16">
                                <div className="flex items-center gap-3">
                                    <div className="w-8 h-8 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center">
                                        <span className="text-white font-bold text-sm">RAS</span>
                                    </div>
                                    <div>
                                        <h1 className="text-xl font-bold text-gray-800">Sistem Inventori Aset RAS</h1>
                                        <p className="text-sm text-gray-600">{availableTabs.find(t => t.id === activeTab)?.label}</p>
                                    </div>
                                </div>
                                
                                <div className="flex items-center gap-4">
                                    <div className="hidden sm:block text-right">
                                        <p className="text-sm font-medium">{user.username}</p>
                                        <p className="text-xs text-gray-500 capitalize">{user.role}</p>
                                    </div>
                                    <button
                                        onClick={handleLogout}
                                        className="px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200"
                                    >
                                        Logout
                                    </button>
                                </div>
                            </div>
                            
                            {/* Tabs Navigation */}
                            <div className="flex overflow-x-auto border-b border-gray-200">
                                {availableTabs.map(tab => {
                                    const TabIcon = tab.icon;
                                    return (
                                        <button
                                            key={tab.id}
                                            onClick={() => setActiveTab(tab.id)}
                                            className={`px-4 py-3 text-sm font-medium whitespace-nowrap border-b-2 transition flex items-center gap-2 ${
                                                activeTab === tab.id 
                                                ? 'border-blue-600 text-blue-600' 
                                                : 'border-transparent text-gray-500 hover:text-gray-700'
                                            }`}
                                        >
                                            <TabIcon />
                                            <span>{tab.label}</span>
                                        </button>
                                    );
                                })}
                            </div>
                        </div>
                    </div>
                    
                    {/* Main Content */}
                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                        {activeTab === 'dashboard' && renderDashboard()}
                        {activeTab === 'inventory' && renderInventory()}
                        {activeTab === 'suppliers' && renderSuppliers()}
                        {activeTab === 'purchase' && renderPurchaseOrders()}
                        {activeTab === 'stocktake' && renderStocktake()}
                        {activeTab === 'barcode' && renderBarcode()}
                        {activeTab === 'locations' && renderLocations()}
                        {activeTab === 'users' && renderUsers()}
                        {activeTab === 'history' && renderHistory()}
                        {activeTab === 'report' && renderReports()}
                        {activeTab === 'settings' && renderSettings()}
                    </div>
                    
                    {/* Footer */}
                    <div className="border-t py-4">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <p className="text-center text-sm text-gray-600">
                                Sistem Inventori Aset RAS ‚Ä¢ Data tersimpan secara lokal ‚Ä¢ {new Date().getFullYear()}
                            </p>
                        </div>
                    </div>

                    {/* Form Modals */}
                    {showItemForm && renderItemForm()}
                    {showSupplierForm && renderSupplierForm()}
                    {showPOForm && renderPOForm()}
                    {showStocktakeForm && renderStocktakeForm()}
                    {showUserForm && renderUserForm()}
                    {showLocationForm && renderLocationForm()}
                </div>
            );
        };

        // ==================== RENDER APP ====================
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>